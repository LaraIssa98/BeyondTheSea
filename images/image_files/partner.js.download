(function(){window.API_VERSION_almosafernew='v2.7.2';})();function insIsLocalStorageSupported(){var insider='insider';try{localStorage.setItem(insider,insider);localStorage.removeItem(insider);return true;}catch(e){return false;}}
if(!insIsLocalStorageSupported()&&typeof console.log!=='undefined'){console.log('LocalStorage Support is not supported. API will not initialize.');}
else if(spApi===undefined){var spApi={};spApi.loadScript=function(url,callback){var script=document.createElement('script')
script.type='text/javascript';script.async='async';if(script.readyState){script.onreadystatechange=function(){if(script.readyState=='loaded'||script.readyState=='complete'){script.onreadystatechange=null;if('function'===typeof callback){callback();}}};}else{script.onload=function(){if('function'===typeof callback){callback();}};}
script.src=url;document.getElementsByTagName('head')[0].appendChild(script);};var sQuery;var protocol='';function insiderMain(){var NO_JQUERY={};(function(a,b,c){if(!("console"in a)){var d=a.console={};d.log=d.warn=d.error=d.debug=function(){}}if(b===NO_JQUERY){b={fn:{},extend:function(){var a=arguments[0];for(var b=1,c=arguments.length;b<c;b++){var d=arguments[b];for(var e in d){a[e]=d[e]}}return a}}}b.fn.pm=function(){return this};b.pm=a.pm=function(a){e.send(a)};b.pm.bind=a.pm.bind=function(a,b,c,d,f){e.bind(a,b,c,d,f===true)};b.pm.unbind=a.pm.unbind=function(a,b){e.unbind(a,b)};b.pm.origin=a.pm.origin=null;b.pm.poll=a.pm.poll=200;var e={send:function(a){var c=b.extend({},e.defaults,a),d=c.target;if(!c.target){return}if(!c.type){return}var f={data:c.data,type:c.type};if(c.success){f.callback=e._callback(c.success)}if(c.error){f.errback=e._callback(c.error)}if("postMessage"in d&&!c.hash){e._bind();d.postMessage(sQuery.toJSON(f),c.origin||"*")}else{e.hash._bind();e.hash.send(c,f)}},bind:function(a,b,c,d,f){e._replyBind(a,b,c,d,f)},_replyBind:function(c,d,f,g,h){if("postMessage"in a&&!g){e._bind()}else{e.hash._bind()}var i=e.data("listeners.postmessage");if(!i){i={};e.data("listeners.postmessage",i)}var j=i[c];if(!j){j=[];i[c]=j}j.push({fn:d,callback:h,origin:f||b.pm.origin})},unbind:function(a,b){var c=e.data("listeners.postmessage");if(c){if(a){if(b){var d=c[a];if(d){var f=[];for(var g=0,h=d.length;g<h;g++){var i=d[g];if(i.fn!==b){f.push(i)}}c[a]=f}}else{delete c[a]}}else{for(var g in c){delete c[g]}}}},data:function(a,b){if(b===c){return e._data[a]}e._data[a]=b;return b},_data:{},_CHARS:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),_random:function(){var a=[];for(var b=0;b<32;b++){a[b]=e._CHARS[0|Math.random()*32]}return a.join("")},_callback:function(a){var b=e.data("callbacks.postmessage");if(!b){b={};e.data("callbacks.postmessage",b)}var c=e._random();b[c]=a;return c},_bind:function(){if(!e.data("listening.postmessage")){if(a.addEventListener){a.addEventListener("message",e._dispatch,false)}else if(a.attachEvent){a.attachEvent("onmessage",e._dispatch)}e.data("listening.postmessage",1)}},_dispatch:function(a){try{var b=sQuery.evalJSON(a.data)}catch(c){return}if(!b.type){return}var d=e.data("callbacks.postmessage")||{},f=d[b.type];if(f){f(b.data)}else{var g=e.data("listeners.postmessage")||{};var h=g[b.type]||[];for(var i=0,j=h.length;i<j;i++){var k=h[i];if(k.origin&&k.origin!=="*"&&a.origin!==k.origin){if(b.errback){var l={message:"postmessage origin mismatch",origin:[a.origin,k.origin]};e.send({target:a.source,data:l,type:b.errback})}continue}function m(c){if(b.callback){e.send({target:a.source,data:c,type:b.callback})}}try{if(k.callback){k.fn(b.data,m,a)}else{m(k.fn(b.data,a))}}catch(c){if(b.errback){e.send({target:a.source,data:c,type:b.errback})}else{throw c}}}}}};e.hash={send:function(b,c){var d=b.target,f=b.url;if(!f){return}f=e.hash._url(f);var g,h=e.hash._url(a.location.href);if(a==d.parent){g="parent"}else{try{for(var i=0,j=parent.frames.length;i<j;i++){var k=parent.frames[i];if(k==a){g=i;break}}}catch(l){g=a.name}}if(g==null){return}var m={"x-requested-with":"postmessage",source:{name:g,url:h},postmessage:c};var n="#x-postmessage-id="+e._random();d.location=f+n+encodeURIComponent(sQuery.toJSON(m))},_regex:/^\#x\-postmessage\-id\=(\w{32})/,_regex_len:"#x-postmessage-id=".length+32,_bind:function(){if(!e.data("polling.postmessage")){setInterval(function(){var b=""+a.location.hash,c=e.hash._regex.exec(b);if(c){var d=c[1];if(e.hash._last!==d){e.hash._last=d;e.hash._dispatch(b.substring(e.hash._regex_len))}}},b.pm.poll||200);e.data("polling.postmessage",1)}},_dispatch:function(b){if(!b){return}try{b=sQuery.evalJSON(decodeURIComponent(b));if(!(b["x-requested-with"]==="postmessage"&&b.source&&b.source.name!=null&&b.source.url&&b.postmessage)){return}}catch(c){return}var d=b.postmessage,f=e.data("callbacks.postmessage")||{},g=f[d.type];if(g){g(d.data)}else{var h;if(b.source.name==="parent"){h=a.parent}else{h=a.frames[b.source.name]}var i=e.data("listeners.postmessage")||{};var j=i[d.type]||[];for(var k=0,l=j.length;k<l;k++){var m=j[k];if(m.origin){var n=/https?\:\/\/[^\/]*/.exec(b.source.url)[0];if(m.origin!=="*"&&n!==m.origin){if(d.errback){var o={message:"postmessage origin mismatch",origin:[n,m.origin]};e.send({target:h,data:o,type:d.errback,hash:true,url:b.source.url})}continue}}function p(a){if(d.callback){e.send({target:h,data:a,type:d.callback,hash:true,url:b.source.url})}}try{if(m.callback){m.fn(d.data,p)}else{p(m.fn(d.data))}}catch(c){if(d.errback){e.send({target:h,data:c,type:d.errback,hash:true,url:b.source.url})}else{throw c}}}}},_url:function(a){return(""+a).replace(/#.*$/,"")}};b.extend(e,{defaults:{target:null,url:null,type:null,data:null,success:null,error:null,origin:"*",hash:false}})})(this,typeof sQuery==="undefined"?NO_JQUERY:sQuery);(function(a){a.cookie=function(b,c,d){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(c))||c===null||c===undefined)){d=a.extend({},d);if(c===null||c===undefined){d.expires=-1}if(typeof d.expires==="number"){var e=d.expires,f=d.expires=new Date;f.setDate(f.getDate()+e)}c=String(c);return document.cookie=[encodeURIComponent(b),"=",d.raw?c:encodeURIComponent(c),d.expires?"; expires="+d.expires.toUTCString():"",d.path?"; path="+d.path:"",d.domain?"; domain="+d.domain:"",d.secure?"; secure":""].join("")}d=c||{};var g=d.raw?function(a){return a}:decodeURIComponent;var h=document.cookie.split("; ");for(var i=0,j;j="undefined"!==typeof h[i]&&h[i].split("=");i++){if(g(j[0])===b)return g(j[1]||"")}return null}})(sQuery);(function($){'use strict';var escape=/["\\\x00-\x1f\x7f-\x9f]/g,meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'},hasOwn=Object.prototype.hasOwnProperty;$.toJSON=typeof JSON==='object'&&JSON.stringify?JSON.stringify:function(o){if(o===null){return'null';}var pairs,k,name,val,type=$.type(o);if(type==='undefined'){return undefined;}if(type==='number'||type==='boolean'){return String(o);}if(type==='string'){return $.quoteString(o);}if(typeof o.toJSON==='function'){return $.toJSON(o.toJSON());}if(type==='date'){var month=o.getUTCMonth()+1,day=o.getUTCDate(),year=o.getUTCFullYear(),hours=o.getUTCHours(),minutes=o.getUTCMinutes(),seconds=o.getUTCSeconds(),milli=o.getUTCMilliseconds();if(month<10){month='0'+month;}
if(day<10){day='0'+day;}if(hours<10){hours='0'+hours;}if(minutes<10){minutes='0'+minutes;}if(seconds<10){seconds='0'+seconds;}if(milli<100){milli='0'+milli;}if(milli<10){milli='0'+milli;}return'"'+year+'-'+month+'-'+day+'T'+
hours+':'+minutes+':'+seconds+'.'+milli+'Z"';}pairs=[];if($.isArray(o)){for(k=0;k<o.length;k++){pairs.push($.toJSON(o[k])||'null');}
return'['+pairs.join(',')+']';}if(typeof o==='object'){for(k in o){if(hasOwn.call(o,k)){type=typeof k;if(type==='number'){name='"'+k+'"';}else if(type==='string'){name=$.quoteString(k);}else{continue;}type=typeof o[k];if(type!=='function'&&type!=='undefined'){val=$.toJSON(o[k]);pairs.push(name+':'+val);}}}return'{'+pairs.join(',')+'}';}};$.evalJSON=typeof JSON==='object'&&JSON.parse?JSON.parse:function(str){return eval('('+str+')');};$.secureEvalJSON=typeof JSON==='object'&&JSON.parse?JSON.parse:function(str){var filtered=str.replace(/\\["\\\/bfnrtu]/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,'');if(/^[\],:{}\s]*$/.test(filtered)){return eval('('+str+')');}throw new SyntaxError('Error parsing JSON, source is not valid.');};$.quoteString=function(str){if(str.match(escape)){return'"'+str.replace(escape,function(a){var c=meta[a];if(typeof c==='string'){return c;}c=a.charCodeAt();return'\\u00'+Math.floor(c/16).toString(16)+(c%16).toString(16);})+'"';}return'"'+str+'"';};}(sQuery));partnerName="almosafernew";partner_site={"scheme":"https","host":"www.almosafer.com"};var partnerMultiDomains='https://ae.almosafer.com,https://sa.almosafer.com';sQuery.each(partnerMultiDomains.split(','),function(i,url){if(url.toLowerCase().indexOf(window.location.hostname)>-1){partner_site={"scheme":location.protocol.replace(':',''),"host":"www."+window.location.hostname.replace('www.','')};}});partner_site.host=partner_site.host.replace(/^www\./,'');var cookieDomain="."+partner_site.host;var isInIFrame=(window.location!=window.top.location);var panelEdit=false;if(isInIFrame==true){sQuery.cookie('ins-panel',1,{expires:1,path:'/',domain:'.'+partner_site.host});panelEdit=true;}
else{sQuery.cookie('ins-panel',null,{expires:-1,path:'/',domain:'.'+partner_site.host});}
if(typeof disabledEdit!='undefined'&&disabledEdit==true){panelEdit=false;}
function loadPanelView(){var js=undefined;var count=0;pm.bind('apiControl',function(){return'1';});if(panelEdit==true){var checkIframe=setInterval(function(){if(count==5&&js==undefined){clearInterval(checkIframe);window.panelEdit=false;panelEdit=false;spApi.init();return false;}
count++;pm({target:window.top,type:'checkIframe',data:{},success:function(result){if(typeof js==='object'){clearInterval(checkIframe);return false;}
var scriptSource=spApi.apiUrl+'edit/';var prototypeInterval=setInterval(function(){if(typeof Prototype!=='undefined'&&Prototype.Version<'1.7'&&Array.prototype.toJSON){delete Array.prototype.toJSON;delete Array.prototype.toArray;clearInterval(prototypeInterval);}},10);setTimeout(function(){if(typeof prototypeInterval!=='undefined'){clearInterval(prototypeInterval);}},3000);js=result;if(typeof js==='object'){window.ActionBuilderSettings=js.config;var appPath=result.config.app.appPath;if(typeof appPath=='undefined'){appPath=scriptSource+'actionbuilder/frame/app.js';}
var html_doc=document.getElementsByTagName('head')[0];var scriptElement=document.createElement('script');scriptElement.setAttribute('language','javascript');scriptElement.setAttribute('type','text/javascript');scriptElement.setAttribute('src',appPath+'?v='+spApi.genDate);html_doc.appendChild(scriptElement);clearInterval(checkIframe);}else{var scriptElement=document.createElement('script');scriptElement.type='text/javascript';scriptElement.src=scriptSource+js+'?'+new Date().getTime();document.getElementsByTagName('head')[0].appendChild(scriptElement);clearInterval(checkIframe);}}});},100);}}
sQuery(document).ready(function(){loadPanelView();});function getAnalytics(callback){esCountAnalytics(callback);}function esCountAnalytics(callback,campId){if(!spApi.isOnProductPage()){return;}
var uniqueID=(spApi.getCurrentProduct()||{}).id;if(typeof uniqueID==='undefined'){return;}
if(typeof window.spPageVisitCount!="undefined"&&typeof callback!="undefined"){callback(window.spPageVisitCount);return;}
if(typeof spApi.analyticsCallbacks=="undefined"){spApi.analyticsCallbacks=[];if(typeof callback!="undefined")
spApi.analyticsCallbacks.push(callback);}else{if(typeof callback!="undefined")
spApi.analyticsCallbacks.push(callback);return;}
var instantView=false;var dailyView=false;var isUniqueView=false;sQuery.each(spApi.notifies,function(i,val){if(val.kkbSettings!=null){sQuery.each(val.kkbSettings,function(kkbIndex,kkbVal){if(kkbIndex=="@instantView"){instantView=true;}
if(kkbIndex=="@dailyView"){dailyView=true;}});}});if(dailyView!=true&&instantView!=true)
return;if(isUniqueView){if(spApi.sessionStorageGet(uniqueID)){isUniqueView=true;}else{spApi.sessionStorageSet(uniqueID,uniqueID);isUniqueView=false;}}
sQuery.ajax({url:"//kkbv2.api.sociaplus.com?t=esCountAnalytics&instantView="+instantView+"&dailyView="+dailyView,data:{uniqueID:uniqueID,partnerName:"almosafernew",isUniqueView:isUniqueView,campId:campId,kkbRandomSettings:spApi.notifies[campId].kkbRandomSettings},type:"get",dataType:"jsonp",async:spApi.isAjaxAsync,jsonpCallback:"parseAnalyticsData",success:function(e){var isDataAvailable=(dailyView&&e.count.dailyView>-1)||(instantView&&e.count.instantView>-1);if(typeof e=="object"&&isDataAvailable){window.success10=e.count.dailyView<10?e.count.dailyView*3:e.count.dailyView;window.spPageVisitCount=e.count;sQuery.each(spApi.analyticsCallbacks,function(i,funct){funct(e.count);});spApi.analyticsCallbacks=undefined;}}});}
function parseAnalyticsData(e){}function esLiveFeed(callback){if(!spApi.isOnProductPage()){return;}
if(typeof window.esFeedData!="undefined"&&typeof callback!="undefined"){callback(window.esFeedData);return;}
if(typeof spApi.historyCallbacks=="undefined"){spApi.historyCallbacks=[];if(typeof callback!="undefined")
spApi.historyCallbacks.push(callback);}else{if(typeof callback!="undefined")
spApi.historyCallbacks.push(callback);return;}
var lastPurchaseTime=false;var dailyPurchase=false;var instantPurchase=false;var inBasket=false;sQuery.each(spApi.notifies,function(id,notify){if(lastPurchaseTime==false&&notify.content.indexOf("@lastPurchasedTime")!=-1){lastPurchaseTime=true;}
if(dailyPurchase==false&&notify.content.indexOf("@dailyPurchase")!=-1){dailyPurchase=true;}
if(instantPurchase==false&&notify.content.indexOf("@instantPurchase")!=-1){instantPurchase=true;}
if(inBasket==false&&notify.content.indexOf("@inBasketCount")!=-1){inBasket=true;}});sQuery.each(spApi.notifies,function(id,notify){if(notify.kkbSettings!=null){sQuery.each(notify.kkbSettings,function(property,value){if(dailyPurchase==false&&property=="@dailyPurchase"){dailyPurchase=true;}
if(lastPurchaseTime==false&&property=="@lastPurchaseTime"){lastPurchaseTime=true;}
if(instantPurchase==false&&property=="@instantPurchase"){instantPurchase=true;}
if(inBasket==false&&property=="@inBasketCount"){inBasket=true;}});}});var uniqueID=(spApi.getCurrentProduct()||{}).id;sQuery.ajax({url:"//kkbv2.api.sociaplus.com?t=getKksHistory&lastPurchaseTime="+lastPurchaseTime+"&dailyPurchase="+dailyPurchase+"&instantPurchase="+instantPurchase+"&inCartCount="+inBasket,data:{uniqueID:uniqueID,partnerName:"almosafernew"},type:"get",dataType:"jsonp",async:spApi.isAjaxAsync,jsonpCallback:"parsehistoryData",success:function(e){window.esFeedData=e;sQuery.each(spApi.historyCallbacks,function(i,funct){funct(e);});spApi.historyCallbacks=undefined;}});function parsehistoryData(e){}
function parseCustomPlusData(e){}
function parseNotifyData(e){}}
protocol=('https:'==document.location.protocol?'https://':'http://');var _json_stringify=JSON.stringify;JSON.stringify=function(object,replacer,space){var Prototype=window.Prototype;if(typeof Prototype!=='undefined'&&Prototype.Version<'1.7'&&Array.prototype.toJSON&&Object.toJSON){return Object.toJSON(object)}
return _json_stringify(object,replacer,space);}
sQuery.fn.extend({exists:function(){return this.length>0;},elementLoadComplete:function(callback,config,notFoundCallback){var defaults={i:10,t:5000};var config=sQuery.extend(defaults,config);var self=this;var i=setInterval(function(){if(sQuery(self.selector).length>0){clearInterval(i);if(typeof callback==='function'){return callback();}}},config.i);setTimeout(function(){if(typeof i!=='undefined'){clearInterval(i);if(typeof notFoundCallback==='function'){notFoundCallback();}}},config.t);return this;}});function setSessionOnlyCookie(cookieName,cookieValue){if(navigator.userAgent.indexOf('MSIE')!==-1||navigator.appVersion.indexOf('Trident/')>0){document.cookie=cookieName+"="+cookieValue+"; path=/";}else{document.cookie=cookieName+'='+cookieValue+';path=/'+';expires='+'0';}}
var getCookies=function(){var pairs=document.cookie.split(";");var cookies={};for(var i=0;i<pairs.length;i++){var pair=pairs[i].split("=");cookies[pair[0]]=unescape(pair[1]);}
return cookies;};var ajaxSupport="0";var initCondition="typeof spPanelPreview != 'undefined' && spPanelPreview != false) || false || spApi.customizationCamps.length > 0 || spApi.camps.length > 0 || sQuery.cookie('sp-notes') != undefined || false ";if(typeof spPanelPreview=="undefined"||spPanelPreview!=true){var disable_camp=false;}
else{var disable_camp=true;}
spApi={loadScript:spApi.loadScript,isAjaxAsync:false,globalUserIdIsDisabled:false,viewedCustomCamps:[],Base64:{_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){if(typeof e==="undefined"||e===null)return false;var t="";var n,r,i,s,o,u,a;var f=0;e=spApi.Base64._utf8_encode(e);while(f<e.length){n=e.charCodeAt(f++);r=e.charCodeAt(f++);i=e.charCodeAt(f++);s=n>>2;o=(n&3)<<4|r>>4;u=(r&15)<<2|i>>6;a=i&63;if(isNaN(r)){u=a=64}else if(isNaN(i)){a=64}t=t+this._keyStr.charAt(s)+this._keyStr.charAt(o)+this._keyStr.charAt(u)+this._keyStr.charAt(a)}return t},decode:function(e){var t="";var n,r,i;var s,o,u,a;var f=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(f<e.length){s=this._keyStr.indexOf(e.charAt(f++));o=this._keyStr.indexOf(e.charAt(f++));u=this._keyStr.indexOf(e.charAt(f++));a=this._keyStr.indexOf(e.charAt(f++));n=s<<2|o>>4;r=(o&15)<<4|u>>2;i=(u&3)<<6|a;t=t+String.fromCharCode(n);if(u!=64){t=t+String.fromCharCode(r)}if(a!=64){t=t+String.fromCharCode(i)}}t=spApi.Base64._utf8_decode(t);return t},_utf8_encode:function(e){try{e=e.replace(/\r\n/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r)}else if(r>127&&r<2048){t+=String.fromCharCode(r>>6|192);t+=String.fromCharCode(r&63|128)}else{t+=String.fromCharCode(r>>12|224);t+=String.fromCharCode(r>>6&63|128);t+=String.fromCharCode(r&63|128)}}return t}catch(err){spApi.errLog(err,{logType:"UTF8 Fonksiyonu Hatası",bugType:"partner",extraData:{fonksiyon:"_utf8_encode",parameter:e}})}},_utf8_decode:function(e){try{var t="";var n=0;var r=0;var c2=0;while(n<e.length){r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r);n++}else if(r>191&&r<224){c2=e.charCodeAt(n+1);t+=String.fromCharCode((r&31)<<6|c2&63);n+=2}else{c2=e.charCodeAt(n+1);c3=e.charCodeAt(n+2);t+=String.fromCharCode((r&15)<<12|(c2&63)<<6|c3&63);n+=3}}return t}catch(err){spApi.errLog(err,{logType:"UTF8 Fonksiyonu Hatası",bugType:"partner",extraData:{fonksiyon:"_utf8_decode",parameter:e}})}}},consoleLog:[],salesSesId:'MA==',goalList:[],goalObserverStatus:false,goalLogs:[],dbLog:[],hitSend:false,errLogActive:true,esResultCheck:function(campId,logic,value,aggrName){return spApi.e("(this.gaDimensionQ['"+campId+"_"+aggrName+"'] "+logic+" "+value+")");},paaProducts:[32,39,47],webPushPermission:{initialized:false,setState:function(pushStorageData){if(pushStorageData.insdrSubsId){spApi.storageData('insUserPermissionGranted',{state:true},{expires:360});}else if(pushStorageData.pushRequestSent){spApi.storageData('insUserPermissionGranted',{state:false},{expires:360});}else{spApi.storageData('insUserPermissionGranted',{state:null},{expires:360});}},initState:function(){spApi.worker.asyncPM('getPushStorageData',{},function(pushStorageData){spApi.webPushPermission.setState(pushStorageData);});},getState:function(){var storageData=JSON.parse(spApi.storageData('insUserPermissionGranted'));if(storageData){return storageData.state;}
return storageData;}},highlight:function(element,options){return sQuery(element).highlight(options);},isset:function(value){return typeof value!=='undefined'&&typeof value!=='unknown';},mask:sQuery.mask,gaDimensionQ:{},getBrowser:function(version,lowerCase){var ua=navigator.userAgent,tem,M=ua.match(/(yabrowser|opera|chrome|safari|firefox|msie|edge|maxthon|trident|ubrowser|ucbrowser(?=\/))\/?\s*(\d+)/i)||[];var done=false;if(/trident/i.test(M[1])){tem=/\brv[ :]+(\d+)/g.exec(ua)||[];M[0]='IE';M[1]=(tem[1]||-1);done=true;}else if(M[1]==='Chrome'){if(ua.match(/\b(Edge)\/(\d+)/)!=null){tem=ua.match(/\b(Edge)\/(\d+)/);done=true;M[0]='Edge';M[1]=(tem[2]||-1);}else if(ua.match(/\b(YaBrowser)\/(\d+)/)!=null){tem=ua.match(/\b(YaBrowser)\/(\d+)/);done=true;M[0]='Yandex';M[1]=(tem[2]||-1);}else if(ua.match(/\b(OPR)\/(\d+)/)!=null){tem=ua.match(/\b(OPR)\/(\d+)/);done=true;M[0]='Opera';M[1]=(tem[2]||-1);}else if(ua.match(/\b(UBrowser)\/(\d+)/)!=null){tem=ua.match(/\b(UBrowser)\/(\d+)/);done=true;M[0]='UCBrowser';M[1]=(tem[2]||-1);}else if(ua.match(/\b(SamsungBrowser)\/(\d+)/)!=null){tem=ua.match(/\b(SamsungBrowser)\/(\d+)/);done=true;M[0]='Samsung Internet';M[1]=(tem[2]||-1);}}
if(ua.match(/\b(coc_coc_browser)\/(\d+)/)!=null||(navigator.vendor&&navigator.vendor=='Coc Coc')){tem=ua.match(/\b(coc_coc_browser)\/(\d+)/)||'';done=true;M[0]='CocCoc';M[1]=(tem[2]||-1);}
if(!done){M=M[2]?[M[1],M[2]]:[navigator.appName,navigator.appVersion,-1];if((tem=ua.match(/version\/(\d+)/i))!=null)
M.splice(1,1,tem[1]);}
if(typeof version!=='undefined'&&version)
return M[1]||-1;if(M[0]=='MSIE')M[0]='IE';if(typeof lowerCase!=='undefined'&&lowerCase)
M[0]=M[0].toLowerCase();return M[0];},conTrace:function(){if(spApi.debugModeIsOpen()&&typeof console.trace!=='undefined'){console.trace.apply(console,arguments);}},errLog:function(error,data){if(typeof data=="undefined"){data={logType:'Bilinmeyen Hata'};}
data.errorName=error.name;data.errorMessage=error.message;data.errorLineNumber=error.lineNumber||'';data.errorStack=error.stack||'';data.partnerName=partnerName;data.bugType=data.bugType||'product';data.url=window.location.href;data.host=window.location.host;data.referrer=window.document.referrer;data.date=new Date().getTime();data.browser=spApi.getBrowser();data.browserVersion=spApi.getBrowser(true);data.browserLang=navigator.language;data.platform=navigator.platform;data.userAgent=navigator.userAgent;if(typeof spApi.errLogs==='undefined'){spApi.errLogs=[];}
spApi.errLogs.push(data);spApi.conTrace(error,data);},isBrowserSupportEnabled:function(){try{var browser=spApi.getBrowser();var version=Number(spApi.getBrowser(true));if(browser=="IE"&&version<=10){return false;}
return true;}
catch(e){spApi.errLog(e);}},isCookieSupportEnabled:function(){try{var data={key:'scs',obj:{'t':1},campId:0};spApi.updateCookie(data);if(sQuery.cookie("scs")!=null){return true}else{return false}}catch(e){spApi.errLog(e)}},bindAutoClose:function(campaign,callback){},isLocalStorageSupport:insIsLocalStorageSupported,getParameterFromUrl:function(url,parameter)
{name=parameter.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");var regexS="[\\?&]"+name+"=([^&#]*)";var regex=new RegExp(regexS);var results=regex.exec(url);if(results==null)
return"";else
return decodeURIComponent(results[1]);},isOptOut:function(){return sQuery.cookie('INSOPTOUT')!==null;},optOutRequestExists:function(){return spApi.hasParameter('INSOPTOUT');},checkOptOut:function(){if(spApi.optOutRequestExists()&&!spApi.isOptOut()){spApi.worker.asyncPM('insOptOut');sQuery.cookie('INSOPTOUT',1,{expires:360,path:'/',domain:cookieDomain});}
return spApi.isOptOut();},resetAddCartCount:function(){var counter=[];localStorage.setItem('addCartCount',counter);},loaded:false,setSeleniumObject:function(data){try{spApi.dbLog=[];sQuery.each(data,function(key,tempLog){var campId=tempLog.campId;if(campId==undefined){spApi.dbLog.push(tempLog);}else{if(spApi.dbLog[campId]==undefined)spApi.dbLog[campId]=[];spApi.dbLog[campId].push(tempLog);}});}catch(err){spApi.errLog(err);}},addDbLog:function(data){try{if(spApi.hasParameter('selenium')||sQuery.cookie('selenium')!=null){var dbData=sQuery.cookie('selenium');dbData=(dbData==null||dbData=='"[]"')?[]:JSON.parse(dbData);var log=[];sQuery.each(dbData,function(key,tempLog){log.push(tempLog);});if(data!=null)log.push(data);sQuery.cookie('selenium',sQuery.toJSON(log),{path:'/',domain:cookieDomain});spApi.setSeleniumObject(log);}}catch(err){spApi.errLog(err);}},showActiveCamp:function(){spApi.activeCamp=spApi.getCampOfThePage(spApi.camps);spApi.showCamp(spApi.activeCamp);},setCustomTrackClass:function(customCamp,controlGroupID){try{if(customCamp&&customCamp.customizationList!=null){sQuery.each(customCamp.customizationList,function(index,cstm){if(typeof cstm.selectorString!="undefined"&&typeof cstm.id!="undefined"){var classSplit=cstm.id.split("-");if(!sQuery(cstm.selectorString).is('[class*="sp-custom-'+controlGroupID+'-'+classSplit[3]+'"]')){sQuery(cstm.selectorString).addClass('sp-custom-'+controlGroupID+'-'+classSplit[3]);}}});}}catch(err){spApi.errLog(err);}},isBannerManagementActive:function(){return typeof spApi.bannerManagementCamps!=='undefined'&&spApi.bannerManagementCamps.length>0;},showCustomCamp:function(customCamp){},clearCustomCamps:function(){},initCustomCamps:function(docReady){},setCampSalesSesId:function(){if(spApi.salesSesId==false){spApi.errLog({name:'Error',message:'salesSessionIdNotExists'},{logType:'salesSesId',bugType:'product',extraData:{salesSesId:spApi.salesSesId}});return;}
var currentCookie='';try{var pairs=spApi.allStorageData();sQuery.each(pairs,function(i,obj){var key=obj.key;var value=obj.value;if(key.indexOf("sp-camp-")!=-1){currentCookie=obj;if(typeof value!=="undefined"){var campId=(key.replace('sp-camp-','')).replace(/^\s+|\s+$/gm,'');var objData=JSON.parse(unescape(value));var sesExpireTime=30*60;if(value.indexOf("salesSesId")==-1){objData.salesSesId=spApi.Base64.decode(spApi.salesSesId);objData.salesSesTime=spApi.getTime();var data={key:'sp-camp-'+campId,obj:objData,campId:campId};spApi.updateCookie(data,'nolog');}else if((parseInt(objData.salesSesTime)+sesExpireTime)>=spApi.getTime()&&objData.salesSesId==spApi.Base64.decode(spApi.salesSesId)){objData.salesSesTime=spApi.getTime();var data={key:'sp-camp-'+campId,obj:objData,campId:campId};spApi.updateCookie(data,'nolog');}}}});}catch(err){spApi.errLog(err,{logType:'setCampSalesSesId',bugType:'product',extraData:{Cookie:currentCookie,salesSesId:spApi.salesSesId}});}},setPushJoinLog:function(){try{var parameter='webPushId';if(spApi.hasParameter(parameter)){var campId=spApi.Base64.decode(decodeURIComponent(spApi.getParameter(parameter)));if(campId!=null&&!isNaN(campId)){var insWp=spApi.storageData('ins-wp-'+campId);if(insWp==null){spApi.updateCookie({key:'ins-wp-'+campId,obj:{joDa:spApi.getTime(),sId:spApi.getGAStyleSesId()},campId:campId},'nolog');spApi.worker.send('do-logging',{type:'webPush',campId:campId,logType:'camp-join',browser:spApi.getBrowser(),isMobile:spApi.isMobileBrowser(),referer:spApi.urlencode(window.location.href),primaryAction:spApi.hasParameter('insider-primary-action'),secondaryAction:spApi.hasParameter('insider-secondary-action')});}else{if(typeof spApi.webPushes[campId]==='undefined'){return false;}
insWp=JSON.parse(insWp);var webPush=spApi.webPushes[campId];var dynamicPushTitle=spApi.parseDynamicPushContent(webPush.title);var dynamicPushDescription=spApi.parseDynamicPushContent(webPush.description);var dynamicContentExist=dynamicPushTitle.customAttributeExist||dynamicPushDescription.customAttributeExist;if(typeof insWp.joDa==="undefined"){insWp.joDa=spApi.getTime();insWp.sId=spApi.getGAStyleSesId();spApi.updateCookie({key:'ins-wp-'+campId,obj:insWp,campId:campId},'nolog');spApi.worker.send('do-logging',{type:'webPush',campId:campId,logType:'camp-join',browser:spApi.getBrowser(),isMobile:spApi.isMobileBrowser(),referer:spApi.urlencode(window.location.href),dynamicContentExist:dynamicContentExist,primaryAction:spApi.hasParameter('insider-primary-action'),secondaryAction:spApi.hasParameter('insider-secondary-action')});}}}}}catch(err){spApi.errLog(err,{logType:'setPushJoinLog',bugType:'product'});}},setJourneyEmailJoinStorage:function(){try{if(!spApi.hasParameter('journeyId')){return;}
var decodedUrl=decodeURIComponent(location.href);var getParameterValue=function(key){return spApi.getParameterFromUrl(decodedUrl,key)}
var eventCode=getParameterValue('event[code]');var eventId=getParameterValue('event[id]');if(eventCode==='EM'){spApi.storageData('ins-journey-email-join-'+eventId,{userId:spApi.storageData('spUID'),journeyId:Number(getParameterValue('journeyId')),campaignId:Number(eventId),eventCode:eventCode+':'+eventId,currentState:getParameterValue('currentState')},{expires:14});}}catch(err){spApi.errLog(err,{logType:'setJourneyEmailJoinStorage',bugType:'product'});}},sendJourneyEmailJoinLog:function(){try{var SALE_LOG_TYPE=5;var logStash=[];spApi.allStorageData().forEach(function(storageData){if(storageData.key.indexOf('ins-journey-email-join')>-1){logStash.push(sQuery.extend({partnerName:partnerName,actionCode:SALE_LOG_TYPE,date:(function(){var date=new Date();return date.toISOString().slice(0,10)+' '+
date.toLocaleTimeString([],{hour12:false});}())},JSON.parse(storageData.value)));}});if(logStash.length>0){sQuery.ajax({url:'https://collector.api.useinsider.com/store',type:'POST',data:JSON.stringify(logStash)});}}catch(err){spApi.errLog(err,{logType:'sendJourneyEmailJoinLog',bugType:'product'});}},setPushSalesLog:function(orderID){try{var pairs=spApi.allStorageData();sQuery.each(pairs,function(i,obj){var key=sQuery.trim(obj.key);if(key.indexOf("ins-wp-")!=-1){var wpCookie=JSON.parse(unescape(obj.value));if(typeof wpCookie!=='undefined'&&wpCookie!=null&&wpCookie.sId==spApi.getGAStyleSesId()){var campId=key.split("-")[2];spApi.worker.send('do-logging',{type:'webPush',campId:campId,logType:'sales-from-click',referer:spApi.urlencode(window.location.href),otherProperties:{sessionId:spApi.getGAStyleSesId(),orderId:orderID,paidProducts:(spApi.storageData('paid-products')!=null)?spApi.storageData('paid-products'):'',originalPrice:spApi.getExchangeRate(spApi.preferredCurrency,sQuery.cookie('current-currency'),sQuery.cookie('total-cart-amount'),'price'),originalCurrency:(sQuery.cookie('current-currency')!=null)?sQuery.cookie('current-currency'):'',convertedCurrency:spApi.preferredCurrency,convertedPrice:(sQuery.cookie('total-cart-amount')!=null)?sQuery.cookie('total-cart-amount'):''}});}}});}catch(err){spApi.errLog(err,{logType:'setPushSalesLog',bugType:'product',extraData:{orderID:orderID}});}},migratingToLocalStorage:function(){var cookies=getCookies();for(var cookie in cookies){try{if(cookie.indexOf("sp-camp")!=-1){var cookieContent=JSON.parse(cookies[cookie]);var campId=cookie.split("-");var campId=campId[2];var getViDa=new Date(cookieContent.viDa*1000);;var getNowDate=new Date();var getDifference=getNowDate.getDate()-getViDa.getDate();var setNewExpireDayCount=spApi.getCamp(campId).camp.cookieTime-getDifference;spApi.storageData(cookie,cookies[cookie],{expires:setNewExpireDayCount});sQuery.cookie(sQuery.trim(cookie),1,{expires:-1,path:'/',domain:cookieDomain});spApi.logger('info',cookie+' cookie migrated to local storage');}
if(cookie.indexOf("cus")!=-1){var customSegmentId=(cookie.replace(/[^\d]/g,''));var customSegment={};sQuery.each(spApi.customSegments,function(index,value){if(value['id']==customSegmentId){customSegment=value;return true;}});if(sQuery.cookie('cus'+customSegmentId)!==null){var expDate=new Date(customSegment.activeDateEnd*1000);spApi.storageData(cookie,cookies[cookie],{expires:expDate});sQuery.cookie(sQuery.trim(cookie),'1',{expires:-1,path:'/',domain:cookieDomain});spApi.logger('info',cookie+' cookie migrated to local storage');}}
if(cookie.indexOf("user-segments")!=-1||cookie.indexOf("paid-products")!=-1){if(cookies[cookie].length>0){var cookieContent=JSON.parse(cookies[cookie]);}
spApi.storageData(sQuery.trim(cookie),cookies[cookie]);sQuery.cookie(sQuery.trim(cookie),1,{expires:-1,path:'/',domain:cookieDomain});spApi.logger('info',cookie+' cookie migrated to local storage');}
if(cookie.indexOf("sp-goal-")!=-1){spApi.storageData(sQuery.trim(cookie),cookies[cookie]);sQuery.cookie(sQuery.trim(cookie),1,{expires:-1,path:'/',domain:cookieDomain});spApi.logger('info',cookie+' cookie migrated to local storage');}
if(cookie.indexOf("prodCats")!=-1){spApi.storageData(sQuery.trim(cookie),cookies[cookie]);sQuery.cookie(sQuery.trim(cookie),1,{expires:-1,path:'/',domain:cookieDomain});spApi.logger('info',cookie+' cookie migrated to local storage');}}catch(err){spApi.errLog(err,{logType:'migratingToLocalStorage',bugType:'product'});}}},removePageOpacity:function(){if(typeof window['insPageShow']==='function'){window['insPageShow']();}},getDataFromDataLayer:function(property,additionalCondition,fallback){var fb=typeof fallback!=='undefined'?fallback:'';var checkCondition=(typeof additionalCondition!=='undefined'&&typeof additionalCondition==='function')?additionalCondition:function(){return true;};return((typeof dataLayer!=='undefined'?dataLayer:[]).filter(function(index){return typeof index[property]!=='undefined'&&checkCondition(index);})[0]||{})[property]||fb;},getDataFromIO:function(type,property,fallback){var fb=typeof fallback!=='undefined'?fallback:'';return(typeof insider_object!=='undefined'&&typeof insider_object[type]!=='undefined'&&typeof insider_object[type][property]!=='undefined')?insider_object[type][property]:fb;},generateProductId:function(path){var pathname=(path||location.pathname).toString();return'ins'+spApi.Base64.encode(pathname).substring(0,5)+spApi.hashCode(pathname).toString().substring(0,5);},pluralForm:{get:function(lang,count,form1,form2,form3,form4){if(typeof spApi.pluralForm[lang]==='undefined'){return form1;}
return spApi.pluralForm[lang](count,form1,form2,form3,form4);},en_US:function(count,form1,form2){return Math.abs(count)==1?form1:form2;},},translations:{"en_US":{"date":{"form1":{"day":"Day","hour":"Hour","minute":"Minute","second":"Second"},"form2":{"day":"Days","hour":"Hours","minute":"Minutes","second":"Seconds"}}}},isSiteUrlCheckFailed:function(){if(typeof spApi.isSiteUrlFailedLogSent!=='undefined'){return true;}
if(window.location.href.indexOf(partner_site.host)<0){spApi.logger('warning','Check your site information!');disable_camp=true;spApi.isSiteUrlFailedLogSent=true;spApi.errLog({name:'siteUrlCheckFailed'},{logType:'siteUrlCheckFailed',bugType:'partner',extraData:{partnerSiteHost:partner_site.host,scriptUrl:spApi.apiUrl}});return true;}
return false;},inited:false,init:function(noLog){try{if(spApi.checkOptOut()){spApi.logger('info','Opt Out');return false;}
if(spApi.storageType=="localStorage"){spApi.migratingToLocalStorage();}
spApi.logger('info','Api init oluyor...');if(!spApi.isBrowserSupportEnabled()){return false;}
if(!spApi.isLocalStorageSupport()){spApi.logger('info','LocalStorage Support Disabled...');return false;}
if(spApi.isSiteUrlCheckFailed()){return false;}
if(!spApi.isCookieSupportEnabled()){spApi.logger('info','Cookie Support Disabled...');return false;}
if(panelEdit===true){return false;}
if(spApi.shouldShowPushPermissionDialog()){spApi.webPushPermission.initState();spApi.nativeOptInSDKCustomPath=false;}
if(spApi.localStorageGet('inLanding')==null)
spApi.storageData('inLanding',window.location.href,{path:'/',domain:cookieDomain});spApi.bounceCamp=undefined;spApi.activeCamps=[];spApi.activeInsights=[];spApi.activeWebPushes=[];spApi.activeConversionPushes={'set':[],'update':[],reset:[]};spApi.conditionCheckList=[];spApi.campCallbacks=[];spApi.userBounced=false;spApi.setAddCartCountFired=false;window.spPageVisitCount=undefined;window.esFeedData=undefined;if(noLog!==undefined){spApi.baseInit(noLog);}
else if(spApi.inited===false){function checkClickCapturingClasses(classList){return typeof classList==='string'&&(classList.indexOf('ins-category-sorting')>-1||classList.indexOf('sp-custom-')>-1||classList.indexOf('sp-goal-')>-1||classList.indexOf('insdr-insight-')>-1);}
document.addEventListener('click',function(event){for(var element=event.target;element;){var classes=element.className;if(checkClickCapturingClasses(classes)){sQuery(document).trigger('clickedElement',element);}
element=element.parentElement;}},!0);spApi.initCustomCamps(false);}
if(spApi.customizationCamps.length===0){spApi.removePageOpacity();}
function completed(){document.removeEventListener('DOMContentLoaded',completed);window.removeEventListener('load',completed);sQuery.ready();}
if(document.readyState==='complete'||(document.readyState!=='loading'&&!document.documentElement.doScroll)){window.setTimeout(sQuery.ready);}else{document.addEventListener('DOMContentLoaded',completed);window.addEventListener('load',completed);}
sQuery(document).ready(function(){if(spApi.inited===true)return false;spApi.inited=true;setTimeout(function(){spApi.baseInit(noLog);},0);});}catch(err){spApi.errLog(err,{logType:'init',bugType:'product',extraData:{param1:noLog}});}},shouldInitializeWebPush:function(){return typeof spApi.getWebPushOfThePage==='function'&&spApi.isWebPushInitialized!==true&&spApi.getBrowser()!=='Safari';},baseInit:function(noLog){try{window.sendEsReq=true;if(typeof noLog==='undefined')
window.noLog=true;else
window.noLog=noLog
spApi.couponAsistanceShow=function(callback){if(typeof callback!="undefined"){if(!Boolean(spApi.couponAsistanceShowEvents))
spApi.couponAsistanceShowEvents=[];spApi.couponAsistanceShowEvents.push(callback);}
return this;}
var freeJs="\nif(spApi.hasParameter('\/hotel\/room')){sQuery(document).off('blur.insiderGeneral','input#common-credit-card-number').on('blur.insiderGeneral','input#common-credit-card-number',function(event){if(typeof spApi.insHotelCartPage==='undefined'){spApi.insHotelCartPage=true;spApi.isWebPushInitialized=false;spApi.reInitOnChange();}});}\nspApi.getFlightOriginDestination=function(){var legData=JSON.parse(spApi.localStorageGet('flightsSearchState')||'{}').legData||{};var originCode=(legData.origin||'').split(' ')[0];var destinationCode=(legData.destination||'').split(' ')[0];var originDestination='';if(originCode!==''&&destinationCode!==''){originDestination=originCode+'-'+destinationCode;}\nreturn originDestination;}\nspApi.getCategoriesFromLocalStorage=function(){var arr=[];var updateCategory=function(cat){if(typeof cat!=='undefined'&&cat!==''){arr.push(cat);}};if(spApi.hasParameter('holiday-package\/traveller\/')){var duration=[];sQuery('.panel__body:visible > div:first > span').each(function(index,item){duration.push(sQuery.trim(sQuery(item).text()));});duration=duration.join(',');return[duration];}\nif(spApi.hasParameter('\/hotels\/')||spApi.hasParameter('\/hotel\/')){var hotelDestination=JSON.parse(spApi.localStorageGet('hotelsSearchState')||'{}');updateCategory(hotelDestination.destination||'');return arr;}\nvar searchFlightData=JSON.parse(spApi.localStorageGet('flightsSearchState')||'{}');var originDestination;originDestination=spApi.getFlightOriginDestination();updateCategory(originDestination);updateCategory((searchFlightData.searchType||''));updateCategory((searchFlightData.cabin||''));if(sQuery('.filter-flights-stops input:checked').length==1&&sQuery('.filter-flights-stops input:checked').attr('id')===\"flights-filters-flights-selected-input-0\"){updateCategory('nonstop');}else{updateCategory('not-nonstop');}\nreturn arr;}";try{spApi.logger('info','Partner Javascript ayarları ekleniyor...');spApi.e('(function(){'+freeJs+'})()');}catch(err){spApi.errLog(err,{logType:'Free Js Syntax Error',bugType:'partner',extraData:{freeJs:freeJs}});}
spApi.triggerCartButton();spApi.initCustomCamps();spApi.getGAStyleSesId();spApi.setPushJoinLog();spApi.setJourneyEmailJoinStorage();spApi.showActiveCamp();if(typeof spApi.getInsightOfThePage=='function'){spApi.getInsightOfThePage();}
if(spApi.shouldInitializeWebPush()){spApi.getWebPushOfThePage();}
spApi.noteTimer();spApi.setCouponAsistant();if(spApi.isOnAfterPaymentPage()){spApi.resetAddCartCount();var spRSStatus=JSON.parse(spApi.sessionStorageGet("spRSStatus"));if(spRSStatus!==null&&spRSStatus!='\"\"'&&spRSStatus!=''&&spRSStatus!==false){sQuery.post(spApi.apiUrl+"ajax.php?t=storeLog&ff",spRSStatus,function(e){spApi.sessionStorageSet("spRSStatus",JSON.stringify(false));}).done(function(){spApi.sessionStorageSet("spRSStatus",JSON.stringify(false));});}}
if(spApi.isOnCartPage())
{var initialCartAmount=spApi.getTotalCartAmount()||0;var insdrCartInterval=setInterval(function(){var changedCartAmount=spApi.getTotalCartAmount()||0;if(initialCartAmount!=changedCartAmount&&spApi.isOnCartPage()){spApi.updateCartCookies();initialCartAmount=changedCartAmount;sQuery(document).trigger('cartAmountUpdated');if(typeof spApi.cartAbandonmentEmail==='function'){for(provider in spApi.emailProviders){if(spApi.emailProviders.hasOwnProperty(provider)&&spApi.emailProviders[provider]===true){spApi.cartAbandonmentEmail(provider);}}}
spApi.conLog("Cart parameters have changed, updating...");spApi.conLog("Updated cart amount is: "+changedCartAmount);}},1000);var pProd=spApi.getPaidProducts();var encodedProducts=JSON.stringify(pProd);var date=new Date();var minutes=30;date.setTime(date.getTime()+(minutes*60*1000));spApi.storageData('paid-products',encodedProducts,{expires:date,path:'/',domain:cookieDomain});spApi.updateCartCount(spApi.getCartCount());}
var useCouponButton=spApi.useCouponButton();if(useCouponButton.button.length>0&&useCouponButton.button.length>0){sQuery(useCouponButton.button).live("click",function(){saveEnteredCoupon(spApi.e(useCouponButton.couponInputText));});}
function saveEnteredCoupon(enteredCoupon){var spNotes=sQuery.cookie('sp-notes');var amount=sQuery.cookie('total-cart-amount');enteredCoupon=sQuery.trim(enteredCoupon);if(spNotes!=null){spNotes=spNotes.split("|");notes=JSON.parse(spNotes[1]);if(notes[enteredCoupon]!=undefined&&notes[enteredCoupon].length>0){var data={};data.type="real-sales-log";data.campId="0";data.referer=enteredCoupon+"%7C-%7C"+amount;data.ref=window.document.referrer;spApi.sessionStorageSet("spRSStatus",JSON.stringify(data));}}}
if(spApi.isOnCartPage()){total=spApi.getTotalCartAmount();var encodedProducts=sQuery.toJSON(spApi.getPaidProducts());sQuery.cookie('total-cart-amount',total,{expires:1,path:'/',domain:cookieDomain});}
if(spApi.isOnAfterPaymentPage()){spApi.setSaLog();if(spApi.activeCamp){var total=sQuery.cookie('total-cart-amount');var paidProducts=spApi.storageData('paid-products');if(paidProducts)
{paidProducts=JSON.parse(paidProducts);var total=parseFloat(total);var min=parseFloat(activeCamp.purMinOrderAmount);if(paidProducts.length&&min<=total)
{spApi.showCamp(spApi.activeCamp);}}}}
if(spApi.isOnProductPage()){}
if(spApi.isOnProductPage()||spApi.isOnCartPage()){sQuery.cookie('current-currency',spApi.getCurrency(),{expires:1,path:'/',domain:cookieDomain});}}catch(err){spApi.errLog(err,{logType:'baseInit',bugType:'partner',extraData:{noLog:noLog}});}},setVersusSalesLog:function(orderId){},sendAdAudience:function(camp){if(camp.productType!=32&&camp.productType!=39&&camp.productType!=47){return;}
var configuration={callback:'fbSend',callbackParams:{campId:camp.id},cookieType:'facebookAds',logMessage:'For this facebook ads campaign fbsend operation already executed. LS Info: '};if(camp.productType==32){configuration={callback:'gaSend',callbackParams:{type:'sendAdAudience',campId:camp.id},cookieType:'adaudience',logMessage:'For this Google Adwords campaign gaSend operation already executed. LS Info: '};}
var checkAudienceStatus=JSON.parse(spApi.storageData('sp-camp-'+camp.id));if(checkAudienceStatus){spApi.logger('warning',configuration.logMessage+JSON.stringify(checkAudienceStatus),camp.id);}else{var adAudienceLSData={key:'sp-camp-'+camp.id,obj:{'step1-displayed':true},campId:camp.id};spApi.updateCookie(adAudienceLSData,configuration.cookieType);spApi[configuration.callback](configuration.callbackParams);}},personalizationSetStatus:false,preferredCurrency:"USD",supportedCurrencies:{"USD":{"AED":3.673,"BHD":0.377,"EUR":0.816,"GBP":0.721,"KWD":0.301,"QAR":3.641,"SAR":3.75}},globalExperiment:{"panelStatus":0,"status":0,"ARate":90,"BRate":10,"gaPush":0},shownCampLimit:{"status":0,"maxCount":3,"timeSpan":1},genDate:1532402760,apiUrl:protocol+"almosafernew.api.sociaplus.com/",staticUrl:protocol+"static.api.sociaplus.com/",frameUrl:"https://almosafernew.api.sociaplus.com/frame.php",target:sQuery("#partnerTarget"),camps:[],journeyAttributeList:[],insights:[],webPushes:[],customSegments:[],personalizationCamps:[],rules:[],triggerText:"",notifies:[],customizationCamps:[],bannerManagementCamps:[],journeyCamps:[],activeBannerManagementCamps:[],showedBMCampOfPage:[],gaCustomVar:1,gaIsActiveCustom:0,gaServiceIsActive:1,gaNonInteraction:1,userSegments:{},gaDataLayerIsActive:0,gaDataLayerSettings:false,ajsData:{},bounceExcludeList:[""],bounceExcludeLeft:-1,bounceExcludeRight:75,defaultVelocity:200,lang:[],spLang:'',storageType:'localStorage',conditionCheckList:[],campCallbacks:[],userBounced:false,setAddCartCountFired:false,logsStack:{},_bindedEvents:{},coeff:{"ecommerce":true,"v":null,"i":null,"t":null,"tMobile":null,"f":{}},customUserAttributes:[],customChannelsTag:[],adwordsApiTags:[],siteUrl:'https://www.almosafer.com',urlParamSep:1,decryptCampName:function(campName){if(campName.indexOf('|-x-|')===0){return decodeURIComponent(window.atob(campName.substring(5)));}
return campName;},loadFramelessScripts:function(scripts){var _arr=sQuery.map(scripts,function(script){return sQuery.ajax({dataType:'script',cache:true,url:spApi.staticUrl+'js/libraries/'+script});});_arr.push(sQuery.Deferred(function(deferred){sQuery(deferred.resolve);}));return sQuery.when.apply(sQuery,_arr);},loadJsonFile:function(fileName,callback){try{var callbackName='jsonpCallback'+(Math.random().toString(16)+'000000000').substr(2,8);this[callbackName]=function(){};sQuery.ajax({url:spApi.apiUrl+'ajax.php?t=getJSONFile',data:{file:fileName,callback:callbackName},contentType:'application/json',dataType:'jsonp',jsonpCallback:callbackName,success:function(data){if(typeof callback==='function'){callback(data);}}});}catch(err){spApi.errLog(err,{logType:'Load Frameless Json File Error',bugType:'product',extraData:{'function':'loadFramlessJsonFile'}});}},getUrl:function(){return window.location.href;},getAllCamps:function(){return spApi.getPrototype('allCamps');},existsStorageData:function(keyString){var exists=false;var allData=spApi.allStorageData();sQuery.each(allData,function(i,obj){var key=obj.key;if(key.indexOf(keyString)!==-1){exists=true;}});return exists;},allStorageData:function(){var pairs=[];try{if(spApi.storageType=='cookie'){var allData=document.cookie.split(';');sQuery.each(allData,function(i,v){var cookie=v.split('=');pairs.push({'key':sQuery.trim(cookie[0]),'value':cookie[1]});});}
else if(spApi.storageType=='localStorage'){var allData={};for(var i=0;i<window.localStorage.length;i++){var dataKey=window.localStorage.key(i);allData[dataKey]=window.localStorage.getItem(dataKey);}
sQuery.each(allData,function(key,val){try{var obj=JSON.parse(val);if(typeof obj['_expires']!=='undefined'&&obj['_expires']>Date.now()){pairs.push({'key':key,'value':obj['data']});}}
catch(e){pairs.push({'key':key,'value':val});}});}}catch(err){spApi.errLog(err,{logType:'All Storage Data Error',bugType:'partner',extraData:{'function':'storageData'}});}
return pairs;},storageData:function(name,content,expireDate,callback){try{content=content!=null&&typeof content==='object'?JSON.stringify(content):content;if(spApi.storageType=='cookie'){if(typeof content==='undefined'){return sQuery.cookie(name);}else{sQuery.cookie(name,content,expireDate);}}else if(spApi.storageType=='localStorage'){if(typeof content==='undefined'){var currDate=new Date().getTime();var storageContent=spApi.localStorageGet(name);try{storageContent=JSON.parse(storageContent);if(storageContent!=null&&storageContent._expires>currDate){return storageContent.data;}else{var obj={action:'delete',name:name};spApi.worker.asyncPM('storageData',obj,callback);localStorage.removeItem(name);return null;}}
catch(e){return storageContent;}}else if(content==null){var obj={action:'delete',name:name};spApi.worker.asyncPM('storageData',obj,callback);localStorage.removeItem(name);return null;}else{var expires=typeof expireDate!=='undefined'?expireDate.expires:1;if(typeof expires==='object'){expires=expires.getTime();}else{var dateObj=new Date().getTime();dateObj+=1000*60*60*24*Number(expires)+10000;expires=dateObj;}
var stObj=new Object();stObj.data=typeof content==='object'?JSON.stringify(content):content;stObj._expires=expires;spApi.localStorageSet(sQuery.trim(name),JSON.stringify(stObj));if(typeof window.insdrSV==='undefined'){var version=sQuery.cookie('insdrSV')!=null?Number(sQuery.cookie('insdrSV')):0;version++;spApi.localStorageSet('insdrSV',version);sQuery.cookie('insdrSV',version,{expires:365,path:'/',domain:cookieDomain});window.insdrSV=version;}
var obj={action:'write',name:name,content:JSON.stringify(stObj)};spApi.worker.asyncPM('storageData',obj,callback);}}}catch(err){spApi.errLog(err,{logType:'Data Storage Error',bugType:'partner',extraData:{'function':'storageData'}});}},_systemRuleError:function(name,func,err){var errLogStr=JSON.stringify(spApi.errLogs)||'';if(errLogStr.indexOf('"ruleName":"'+name+'"')!=-1)return;spApi.errLog(err,{logType:'System Rule Error',bugType:'partner',extraData:{ruleName:name,ruleContent:func.toString()}});},getPaidProducts:function(){try{var funcString="(function(){\nvar arr=[];var tmpName;if(spApi.hasParameter('hotel')||spApi.hasParameter('\/holiday-package\/payment\/cart-')){if(window.insHotelCartPage===true||spApi.hasParameter('\/holiday-package\/payment\/cart-')){var tmp=spApi.getCurrentProduct();delete tmp['cats'];arr.push(tmp);}else{var a={};var numberOfNights=Number(sQuery.trim(sQuery('.hotel_details_panel__checkout > ul > li:eq(2)').text()).split(' ').pop())||Number(sQuery('.checkin-arrow ~ span:first').text().replace(\/[^0-9]\/g,'')||1);var tmpPrice=parseFloat((parseFloat(sQuery.trim(sQuery('.total-payment__title .ab-total-payment--original').text()||sQuery('.total-payment__title:first').text()).split(' ').pop().replace(\/[^0-9.]\/g,'')||0)\/numberOfNights).toFixed(2));tmpName=sQuery.trim((spApi.getDataFromDataLayer('selectedHotel')||{}).name||sQuery('.hotel_details_panel h4').text()||sQuery('.panel-exception__info h4').text());a.name=encodeURIComponent(tmpName);a.id=tmpName;a.price=parseFloat(((parseFloat(sQuery('h2').text().replace(\/[^0-9.]\/g,'')||sQuery('.cart-total span').text().replace(\/[^0-9.]\/g,''))||tmpPrice)\/numberOfNights).toFixed(2));a.originalPrice=a.price;a.img=encodeURI(sQuery('.panel-exception__img.img-rounded').attr('src')||sQuery('.hotel_details_panel__hotel_pic > img').attr('src')||'');a.exchange='from '+spApi.getCurrency()+' to '+spApi.preferredCurrency;a.time=spApi.getTime();a.url='';a.quantity=numberOfNights;if(typeof window.hotel_info!=='undefined'&&typeof window.hotel_info[0]!=='undefined'&&typeof window.hotel_info[0].code!=='undefined'){a.url='https:\/\/www.almosafer.com\/'+(location.pathname.split('\/')[1]||'en')+'\/hotel\/details\/'+(sQuery.cookie('insHotelId')||'')}\narr.push(a);}}else if(spApi.hasParameter('flight')){tmpName=sQuery.trim(sQuery('.flights-summary__details-title-text:first').text());tmpPrice=parseFloat(sQuery('.total-payment__title').text().split(' ').pop().replace(\/[^0-9.]\/g,'')||0);arr.push({name:encodeURIComponent(tmpName),id:location.pathname.split('\/').slice(-1)[0]+' '+spApi.getFlightOriginDestination(),price:tmpPrice,originalPrice:tmpPrice,img:'',url:window.location.href,exchange:'from '+spApi.getCurrency()+' to '+spApi.preferredCurrency,quantity:1,time:spApi.getTime()});}\narr=spApi.getExchangeRate(spApi.getCurrency(),spApi.preferredCurrency,arr,'price');return spApi.getExchangeRate(spApi.getCurrency(),spApi.preferredCurrency,arr,'originalPrice');})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getPaidProducts',funcString,err);}},getCurrentProduct:function(){try{var funcString="(function(){\nvar p={};if(spApi.hasParameter('\/flight\/')){p.id=window.location.href.split('\/').pop();var originCode=spApi.localStorageGet('flight_origin_code');var destinationCode=spApi.localStorageGet('flight_destination_code');if(originCode!==null&&destinationCode!==null){p.id+=' '+originCode+'-'+destinationCode;}\np.name=encodeURIComponent(sQuery.trim(sQuery('.flights-summary__details-title-text:first').text()));p.img='';p.price=parseFloat(sQuery('.total-payment__title:first span').text().replace(\/[^0-9.]\/g,''))||0;}else if(spApi.hasParameter('\/holiday-package')){p.id=sQuery.trim(sQuery('.panel-body__heading__title-content .panel-body__title').text());p.name=encodeURIComponent(p.id);p.img=encodeURI(sQuery('.panel-body__heading__img-content > img').attr('src')||'');p.price=parseFloat(sQuery('.summarized-details__content .total-payment__title:visible').text().split(' ').pop().replace(\/[^0-9.]\/g,'')||0);}else if(spApi.hasParameter('\/hotel\/room')){var numberOfNights=Number(sQuery.trim(sQuery('.hotel_details_panel__checkout > ul > li:eq(2)').text()).split(' ').pop())||Number(sQuery('.checkin-arrow ~ span:first').text().replace(\/[^0-9]\/g,'')||1);var tmpName=sQuery.trim(sQuery('.hotel_details__name').text()||sQuery('.panel-exception__info h4').text());p.price=parseFloat((parseFloat(sQuery.trim(sQuery('.total-payment__title .ab-total-payment--original').text()||sQuery('.total-payment__title:first').text()).split(' ').pop().replace(\/[^0-9.]\/g,'')||0)\/numberOfNights).toFixed(2));p.img=encodeURI(sQuery('.panel-exception__img.img-rounded').attr('src')||sQuery('.hotel_details_panel__hotel_pic > img').attr('src')||'');p.name=encodeURIComponent(tmpName);p.id=tmpName||location.pathname.split('\/').pop()||'';p.quantity=numberOfNights;}\np.originalPrice=p.price;p.url=window.location.href;p.cats=spApi.getProductCategories();p.exchange='from '+spApi.getCurrency()+' to '+spApi.preferredCurrency;if(typeof p.quantity==='undefined'){p.quantity=1;}\np=spApi.getExchangeRate(spApi.getCurrency(),spApi.preferredCurrency,p,'price');return spApi.getExchangeRate(spApi.getCurrency(),spApi.preferredCurrency,p,'originalPrice');})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getCurrentProduct',funcString,err);}},getTotalCartAmount:function(){try{var funcString="(function(){\nvar tmpPrice=parseFloat((sQuery('.tj-booking-details__fare-total .tj-rate__price').text()||sQuery('.ab-total-payment--original:first').text()).replace(\/[^0-9.]\/g,'')||sQuery('.total-payment__title .pull-right:first').text().replace(\/[^0-9.]\/g,'')||0);return spApi.getExchangeRate(spApi.getCurrency(),spApi.preferredCurrency,tmpPrice);})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getTotalCartAmount',funcString,err);}},isOnCartPage:function(){try{var funcString="(function(){\nreturn(spApi.hasParameter('\/hotel\/room')&&spApi.insHotelCartPage===true)||(spApi.hasParameter('holiday-package\/payment\/cart-')&&sQuery('.credit-card__form-container').exists())||(spApi.hasParameter('flight\/seat\/cart-')&&sQuery('.deltaApp-flight-details-payment').exists())||(sQuery('.credit-card-wrapper-new:visible').exists()&&spApi.hasParameter('\/room-new\/cart-')&&sQuery('.breadcrumb_steps__line.breadcrumb_steps__line--waiting > span:eq(2)').hasClass('breadcrumb_steps__step--active'));})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnCartPage',funcString,err);}},isOnAfterPaymentPage:function(){try{var funcString="(function(){\nreturn(spApi.hasParameter('hotel\/booking')||spApi.hasParameter('flight\/booking')||spApi.hasParameter('holiday-package\/booking'))&&(sQuery('.breadcrumb.breadcrumb-steps li:last span .tj-icon.tj-icon--checkmark').exists()||sQuery('.box-successful__text.font-weight-300').exists());})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnAfterPaymentPage',funcString,err);}},isOnProductPage:function(){try{var funcString="(function(){\nreturn(spApi.hasParameter('flight\/traveller\/')&&sQuery('.breadcrumb li:eq(2)').hasClass('done'))||(spApi.hasParameter('hotel\/room\/')&&sQuery('hotel-payment').exists()&&typeof spApi.insHotelCartPage==='undefined')||(spApi.hasParameter('room-new\/cart-')&&!sQuery('.credit-card-wrapper-new:visible').exists());})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnProductPage',funcString,err);}},getProductCategories:function(){try{var funcString="(function(){\nvar arr=spApi.getCategoriesFromLocalStorage();var tmp=sQuery.trim(sQuery('#main-nav .navbar-nav:first li.active').text());if(tmp!==''){arr.unshift(tmp);}\nif(spApi.hasParameter('\/hotel\/')){var numberOfStars=Number((sQuery(\".www-rating-stars__lst--active:visible\").attr(\"style\")||'').split('width:').pop().split(';')[0].replace(\/[^0-9]\/g,''))\/20;numberOfStars=numberOfStars===0?sQuery('.www-rating-stars__lst--active > li').length:numberOfStars;arr.push(numberOfStars+'-stars');}\nreturn arr;})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getProductCategories',funcString,err);}},spAddToCart:function(){try{var funcString="(function(){})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('spAddToCart',funcString,err);}},getOrderId:function(){try{var funcString="(function(){\nreturn((location.pathname.split('booking\/')[1]||'').split('\/')[0]||sQuery.trim((sQuery('.text-sky-blue').text()||'').split(' ')[2]));})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getOrderId',funcString,err);}},getLang:function(lang){try{var funcString="(function(){\nreturn(sQuery('html').attr('lang')=='ar')?'ar_AR':'en_US';})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getLang',funcString,err);}},useCouponButton:function(){try{var funcString="(function(){\nvar useCouponButton=new Object();useCouponButton.button=\"\";useCouponButton.buttonClick=\"\";useCouponButton.couponInputText=\"\";useCouponButton.couponInput=\"\";return useCouponButton})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('useCouponButton',funcString,err);}},isUserLoggedIn:function(){try{var funcString="(function(){\nreturn sQuery('#common-myaccount-logout-cta').exists();})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isUserLoggedIn',funcString,err);}},isOnRegSuccessPage:function(){try{var funcString="(function(){\nreturn false})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnRegSuccessPage',funcString,err);}},getSearchKeyWords:function(){try{var funcString="(function(){\nreturn\"\";})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getSearchKeyWords',funcString,err);}},isOnMainPage:function(){try{var funcString="(function(){\nvar pathName=location.pathname.split('\/').pop();return pathName==='en'||pathName==='ar'||sQuery('.hotels-home-offer').exists();})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnMainPage',funcString,err);}},isOnCouponPage:function(){try{var funcString="(function(){\nreturn spApi.hasParameter('cart');})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnCouponPage',funcString,err);}},isOnCategoryPage:function(){try{var funcString="(function(){\nvar pathname=location.pathname.split('\/').pop();return sQuery('#hotel-search-result-container').exists()||sQuery('.flights-search-results-container').exists()||sQuery('.packages-home').exists()||(sQuery('.travel-offers, .deltaApp-worldcup-home, .deltaApp-packages-home, .deltaApp-main-hotels, .deltaApp-main-flights').exists()&&!spApi.isOnMainPage())||(pathname===\"hotels-home\"||pathname===\"offers\"||pathname===\"flights-home\");})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnCategoryPage',funcString,err);}},getCategories:function(){try{var funcString="(function(){\nvar arr=[];if(spApi.hasParameter('\/holiday-package\/')){sQuery('.packages-breadcrumbs__list li').each(function(index,item){arr.push(sQuery.trim(sQuery(item).text()))});return arr;}\nvar tmp=sQuery.trim(sQuery('#main-nav .navbar-nav:first li.active').text());if(location.pathname.split('\/').length===3){return[tmp];}\narr=spApi.getCategoriesFromLocalStorage();tmp!==''&&arr.unshift(tmp);return arr;})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getCategories',funcString,err);}},setEmailToCookie:function(){try{var funcString="(function(){\nreturn false;})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('setEmailToCookie',funcString,err);}},sliderSettings:function(){try{var funcString="(function(){\nreturn{isElementInSlider:function(element){return false;},getImageList:function(){var imageList=[];return imageList;},triggerClick:function(){var clickSelector='#rev_slider_1_1 .slidelink a';spApi.cstmClickHandler(clickSelector);},changeSlider:function(slide,order,logClass){if(logClass!=undefined){}}}})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('sliderSettings',funcString,err);}},getVersusProductDetail:function(){try{var funcString="(function(){})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getVersusProductDetail',funcString,err);}},getCurrency:function(){try{var funcString="(function(){\nreturn spApi.stringToCurrency(sQuery.trim(sQuery('#common-currency-dropdown-cta-desktop > a').text()));})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getCurrency',funcString,err);}},triggerCartButton:function(){try{var funcString="(function(){})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('triggerCartButton',funcString,err);}},getCartCount:function(){try{var funcString="(function(){\nreturn 0;})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getCartCount',funcString,err);}},categorySettings:function(){try{var funcString="(function(){\nreturn{getCategoryList:function(){var categoryList=[];return categoryList;},triggerClick:function(){spApi.categoryClickHandler(\"#menu ul.navbar-nav > li > a\");},changeCategory:function(category,fromIndex,toIndex,logClass){if(fromIndex>toIndex){}else{}\nif(logClass!=undefined){}},getElementCategoryText:function(element){return sQuery(element).text();}}})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('categorySettings',funcString,err);}},setCouponAsistant:function(couponSet,fromPurcha){},setProductCategory:function(){try{var currentProduct=spApi.getCurrentProduct();var category=sQuery.map(spApi.getProductCategories(),function(val,index){var str=val;return str;}).join("|");var p={cat:category,name:currentProduct.name,id:currentProduct.id};var encoded=spApi.storageData('prodCats');var prodCats=[];if(encoded){prodCats=JSON.parse(encoded);}
for(i in prodCats){if(prodCats[i].name==p.name){prodCats.splice(i,1);}}
prodCats.push(p);spApi.storageData('prodCats',sQuery.toJSON(prodCats),{expires:1,path:'/',domain:cookieDomain});}
catch(err){spApi.errLog(err,{logType:'setProductCategory',bugType:'product'});}},spRefId:"_spRefCode",urlencode:function(str){str=(str+'').toString();return encodeURIComponent(str).replace(/!/g,'%21').replace(/'/g,'%27').replace(/\(/g,'%28').replace(/\)/g,'%29').replace(/\*/g,'%2A').replace(/%20/g,'+');},getAppliedCode:function(campId){var couponCode='';var cookieData=JSON.parse(sQuery.cookie('sp-noteTimer'));if(cookieData!=null&&cookieData['cId']!=undefined&&cookieData['cId']==campId){if(cookieData['code']!=undefined&&cookieData['couponApply']!=undefined&&cookieData['couponApply']=='applied'){if(cookieData['encoded']!=undefined&&cookieData['encoded']=='true'){couponCode=spApi.Base64.decode(cookieData['code']);}else{couponCode=cookieData['code'];}}}
return couponCode;},updateTotalCartAmount:function(price,increase){var totalAmount=Number(sQuery.cookie('total-cart-amount'))||0;sQuery.cookie('total-cart-amount',increase?(totalAmount+Number(price)):(totalAmount-Number(price)>0?(totalAmount-Number(price)):0),{expires:1,path:'/',domain:partner_site.host});sQuery(document).trigger('cartAmountUpdated');},storeCartProductStorage:function(productList){var cartProductsStorageName='ins-cart-product-list';var twelveHoursAsMilliSeconds=60*60*12*1000;var date=new Date();date.setTime(date.getTime()+twelveHoursAsMilliSeconds);spApi.storageData(cartProductsStorageName,productList,{expires:date,domain:cookieDomain,path:'/'});},getCartProductStorage:function(){return spApi.cachedProductList||((sQuery.parseJSON(spApi.storageData('ins-cart-product-list'))||{}).productList)||[];},storeCartProductInformation:function(productInformation,quantityConfig){if(typeof productInformation==='undefined'&&productInformation.id===undefined){return;}
var cartProductsStorageName='ins-cart-product-list';var currentProductList=JSON.parse(spApi.storageData(cartProductsStorageName)||'{"totalQuantity": 0, "productList": []}');productInformation.quantity=productInformation.quantity||1;function adjustQuantityOfProduct(){var existingProduct=findMatchingProduct();if(Object.keys(existingProduct).length>0){if(typeof quantityConfig.increase!=='undefined'&&quantityConfig.increase){existingProduct.quantity+=Number(quantityConfig.count);productInformation=existingProduct;}else if(existingProduct.quantity>0&&typeof quantityConfig.increase!=='undefined'&&!quantityConfig.increase){existingProduct.quantity-=Number(quantityConfig.count);productInformation=existingProduct;}}}
function findMatchingProduct(){var foundProduct={};currentProductList.productList.map(function(product){if(product.id!==undefined&&product.id===productInformation.id){foundProduct=product;}});return foundProduct;}
function setTotalQuantity(){var totalQuantity=0;currentProductList.productList.forEach(function(product){if(product.id!==undefined){totalQuantity+=product.quantity;}});currentProductList.totalQuantity=totalQuantity;}
adjustQuantityOfProduct();if(Object.keys(findMatchingProduct()).length===0){currentProductList.productList.push(productInformation);}
setTotalQuantity();spApi.storeCartProductStorage(currentProductList);sQuery(document).trigger('changingCartCount');},updateCartCount:function(count){var cartProductsStorageName='ins-cart-product-list';var currentCartProductList=JSON.parse(spApi.storageData(cartProductsStorageName)||'{}');currentCartProductList.totalQuantity=count;currentCartProductList.productList=spApi.getPaidProducts();spApi.storeCartProductStorage(currentCartProductList);sQuery(document).trigger('cartAmountUpdated');},updateCartCookies:function(){var pProd=spApi.getPaidProducts();var date=new Date();date.setTime(date.getTime()+(30*60*1000));spApi.storageData('paid-products',JSON.stringify(pProd),{expires:date,path:'/',domain:cookieDomain});sQuery.cookie('total-cart-amount',spApi.getTotalCartAmount(),{expires:1,path:'/',domain:cookieDomain});sQuery.cookie('current-currency',spApi.getCurrency(),{expires:1,path:'/',domain:cookieDomain});},stringToCurrency:function(currency){try{currency=currency.replace(/^\s+|\s+$/g,'').toUpperCase();var search=['TL','YTL','€','EURO','$','DÓLAR','£','₽','руб','НАТИРАТЬ','₺','EU','US','ZŁ','¥','ЕУР'];var change=['TRY','TRY','EUR','EUR','USD','USD','GBP','RUB','RUB','RUB','TRY','EUR','USD','PLN','JPY','RSD'];sQuery.each(search,function(key,value){currency=(search[key]==currency)?currency.replace(search[key],change[key]):currency;});return currency;}catch(err){spApi.errLog(err);}},setExchangeRate:function(fromCurrency,toCurrency,price){try{if(fromCurrency!=toCurrency&&fromCurrency!=''&&toCurrency!=''){price=(price!=null&&typeof(price)!="number")?price.replace(/[^0-9.,]/g,''):price;if(typeof spApi.webPushUtilities==='object'){spApi.webPushUtilities.unconvertedCurrentPrice=price;}
if(price!=null&&!isNaN(price)){if(spApi.supportedCurrencies[fromCurrency]!=undefined){if(spApi.supportedCurrencies[fromCurrency][toCurrency]!=undefined)
return(Math.round(spApi.supportedCurrencies[fromCurrency][toCurrency]*price*1000)/1000);}
if(spApi.supportedCurrencies[toCurrency]!=undefined){if(spApi.supportedCurrencies[toCurrency][fromCurrency]!=undefined)
return(Math.round((1/spApi.supportedCurrencies[toCurrency][fromCurrency])*price*1000)/1000);}}}
return price;}catch(err){spApi.errLog(err);}},getExchangeRate:function(fromCurrency,toCurrency,data,element){try{switch(typeof data){case'number':var convertedPrice=spApi.setExchangeRate(fromCurrency,toCurrency,data);break;case'string':var convertedPrice=(isNaN(data))?data:spApi.setExchangeRate(fromCurrency,toCurrency,parseFloat(data));break;case'object':if(data!=null){if(data.length==undefined){if(data.hasOwnProperty(element)){if(element==='price'){data['notConvertedPrice']=data['price'];}
data[element]=spApi.setExchangeRate(fromCurrency,toCurrency,data[element]);}}else{for(var i=0;i<data.length;i++){if(data[i].hasOwnProperty(element)){if(element==='price'){data[i]['notConvertedPrice']=data[i]['price'];}
data[i][element]=spApi.setExchangeRate(fromCurrency,toCurrency,data[i][element]);}}}}
var convertedPrice=data;break;default:var convertedPrice=data;}
return convertedPrice;}catch(err){spApi.errLog(err);}},writeConsoleLog:function(){try{if(typeof spApi.consoleLog==='object'){sQuery(spApi.consoleLog).each(function(id,text){spApi.logger('info',text);});}}catch(err){spApi.errLog(err,{logType:'writeConsoleLog',bugType:'product'});}},getCampSalesSesInfo:function(campId,objType,productType){try{campId=((productType=='20')&&(campId.toString().indexOf('c')==-1))?'c'+campId:campId;var cmp=spApi.storageData('sp-camp-'+campId);if(cmp==null||cmp==undefined){return'0';}else{var obj=JSON.parse(cmp);return(obj[objType]==undefined)?'0':obj[objType];}}catch(err){spApi.errLog(err);}},getBuilderIdFromVar:function(campId)
{var segments=JSON.parse(spApi.storageData('user-segments'));for(var i in segments){if(segments[i]==campId)return i;}
return false;},getBuilderIdFromPersonalizations:function(campId)
{var builderID=false;sQuery.each(spApi.personalizationCamps,function(id,personalization){sQuery.each(personalization.variations,function(key,variation){if(variation.varId==campId){builderID=id;return false;}});if(builderID){return false;}});return builderID;},e:function(js)
{return eval(js);},concat:function(camps,objects)
{sQuery.each(objects,function(i,obj){camps.push(obj);});return camps;},isCurrentCampBM:function(builderID){return sQuery.grep(spApi.bannerManagementCamps,function(camp){return camp.builderID==builderID;}).length!==0;},getBMPersonalization:function(builderID){return sQuery.grep(spApi.bannerManagementCamps,function(camp){return camp.builderID==builderID;})[0];},getCampOfThePage:function(campaignList)
{try{var mobileCamps=[];var webCamps=[];var tabletCamps=[];function collectCampaignsOnList(platformSpecificCampaignList,campaign){platformSpecificCampaignList.forEach(function(list){list.push(campaign);});};sQuery.each(campaignList,function(index,campaign){if(spApi.isMobileCamp(campaign)){collectCampaignsOnList([mobileCamps],campaign);}else if(spApi.isTabletCamp(campaign)){collectCampaignsOnList([tabletCamps],campaign);}else if(spApi.isAllPagesCamp(campaign)){collectCampaignsOnList([webCamps,tabletCamps,mobileCamps],campaign);}else{collectCampaignsOnList([webCamps],campaign);}});if(spApi.deviceDetect('PC')){campaignList=webCamps;}else if(spApi.deviceDetect('Mobil')){campaignList=mobileCamps;}else if(spApi.deviceDetect('Tablet')){campaignList=tabletCamps;}
if(spApi.isMobileBrowser()){var isControlGroupAdaptive;var recentProductId='31';var infoProductType='24';function isCustomCampaign(campaign){return campaign.id.indexOf('c')>-1;}
function campaignIsMultiDevice(campaign){return campaign.productType==recentProductId||isCustomCampaign(campaign)||(campaign.productType==infoProductType&&(spApi.notifies[campaign.id].mode=='adaptive'||isControlGroupAdaptive))}
function campaignIsSegmentedAsMultiDevice(segmentString){return(segmentString.indexOf('Mobil')>-1||segmentString.indexOf('Tablet')>-1||segmentString.indexOf('spApi.deviceDetect("All")')>-1);}
sQuery.each(webCamps,function(index,webCamp){if(webCamp.platform=="tablet"||webCamp.platform=="mobile"){return;}
isControlGroupAdaptive=false;if(webCamp.productType=='24'&&spApi.isControlCamp(webCamp.id)){var personalizationId=spApi.getPersonalizationId(webCamp.id);var personalizationVariations=spApi.personalizationCamps[personalizationId].variations;sQuery.each(personalizationVariations,function(index,variation){if(variation.varId!=webCamp.id){var tmpCamp=spApi.getCamp(variation.varId).camp;if(tmpCamp.productType=='24'&&spApi.notifies[tmpCamp.id].mode=='adaptive'){isControlGroupAdaptive=true;}}});}
if(campaignIsMultiDevice(webCamp)){var segment=webCamp.showIn.segment||[];sQuery.each(segment,function(index,segmentId){if(segmentId!==null){var segmentString=spApi.rules[segmentId].test;if(campaignIsSegmentedAsMultiDevice(segmentString)&&spApi.e(spApi.rules[segmentId].test)){campaignList.push(webCamp);}}});}});}else{campaignList=webCamps;}
spApi.getPersonalizationCamp();var now=Math.round(new Date()/1000);activeCamp=false;spApi.activeCamps=[];sQuery.each(campaignList,function(index,camp){if(!spApi.checkVarSegment(camp)){return true;}
if(!spApi.isCookieSupportEnabled()){return true;}
camp.trigTimeCount=(typeof camp.trigTimeCount=="undefined")?0:camp.trigTimeCount;var dateChecked=(camp.activeDateStart<now&&now<camp.activeDateEnd)?true:false;var showThis=true;var hideThis=false;var isFreqRuleOk=false;var isFreqRuleExist=false;if(camp.hideIn!=undefined&&camp.hideIn.length>0){sQuery.each(camp.hideIn,function(index,value){id=value;rule=spApi.rules[id];if(spApi.ruleControl(rule,camp)){hideThis=true;showThis=false;}
if(!spApi.checkCampaignLanguage(camp)){hideThis=true;showThis=false;}
if(camp.showIn.length<=0&&hideThis!=true){showThis=true;}});}
if(!hideThis&&camp.showIn)
{if(camp.showIn.segment!=undefined&&camp.showIn.segment[0]!=null){sQuery.each(camp.showIn.segment,function(i,id){showThis=true;rule=spApi.rules[id];if(!spApi.ruleControl(rule,camp)){showThis=false;return false;}
if(!spApi.checkCampaignLanguage(camp)){showThis=false;}});}
if(camp.showIn.trigger!=undefined&&camp.showIn.trigger[0]!=null&&camp.trigTimeCount==0){var triggerStatus=false;sQuery.each(camp.showIn.trigger,function(i,id){rule=spApi.rules[id];if(!spApi.ruleControl(rule,camp)){triggerStatus=triggerStatus||false;}else{triggerStatus=triggerStatus||true;}});showThis=showThis&&triggerStatus;if(!spApi.checkCampaignLanguage(camp)){showThis=false;}}
if(typeof camp.showIn[0]!="undefined"){sQuery.each(camp.showIn,function(i,id){showThis=true;rule=spApi.rules[id];if(!spApi.ruleControl(rule,camp)){showThis=false;return false;}
if(!spApi.checkCampaignLanguage(camp)){showThis=false;}});}
if(isFreqRuleExist)
showThis=showThis&&isFreqRuleOk;}
if(camp.locationisActive==1&&spApi.isMobileBrowser()){hideThis=true;showThis=false;}else{if(camp.productType!=20&&sQuery.cookie('sp-noteTimer')!=null){showThis=false;}
if(!spApi.checkDailyDisplay(camp)){showThis=false;}
if(showThis)
{if(spApi.checkConditionNeed(camp)&&spApi.storageData('sp-camp-'+camp.id)){return true;}
if(!dateChecked){return true;}
spApi.activeCamps.push(camp);if(sQuery.inArray(parseInt(camp.productType),spApi.paaProducts)>-1){return true;}
if(!activeCamp||parseInt(activeCamp.priority)>parseInt(camp.priority)){activeCamp=camp;}}}});if(!activeCamp)return false;spApi.activeCamp=activeCamp;spApi.logger('info','Aktif kampanya : '+spApi.activeCamp.id);return spApi.activeCamp;}catch(err){spApi.errLog(err,{logType:'getCampOfThePage',bugType:'product',extraData:{param1:campaignList}});}},setNotificationHeightFromContent:function(pmTarget,callback){sQuery(pmTarget).pm(function(data){var frameConfig={height:sQuery('#insider-notification-content').outerHeight()};return frameConfig;},function(config){return callback(config);});},setInlineNotificationHeightFromContent:function(pmTarget,callback){sQuery(pmTarget).pm(function(data){var frameConfig={height:sQuery('#insider-notification-content').outerHeight()};return frameConfig;},function(config){return callback(config);});},setSocialProofNotificationContent:function(pmTarget,campId,callback){spApi.notifies[campId]['kkbSettings']={'@instantView':1,'@dailyView':1,'@dailyPurchase':1,'@instantPurchase':1,'@inBasketCount':1};esCountAnalytics(function(countAnalytics){esLiveFeed(function(liveFeed){sQuery(pmTarget).pm(function(data){var kkbData={'@instantView':data.countStat.instantView,'@dailyView':data.countStat.dailyView,'@dailyPurchase':data.liveFeed.purchase.dailyPurchase,'@instantPurchase':data.liveFeed.purchase.instantPurchase,'@inBasketCount':data.liveFeed.inBasketCount};var display=true;var textArea=sQuery('.social-proof-text-area .element-editable,.inline-social-proof-text-area .element-editable');var minimum=data.socialProofSettings.min;var random=data.socialProofSettings.random;sQuery.each(data.kkbSettings,function(key,value){if(textArea.html().indexOf(key)>=0){if(kkbData[key]>0&&minimum[key]<=kkbData[key]){textArea.html(textArea.html().replace(key,kkbData[key]));}else{display=false;}}});var frameConfig={height:sQuery('.swiper-slide-active').height(),display:display};return frameConfig;},function(config){return callback(config);},{countStat:countAnalytics,liveFeed:liveFeed,kkbSettings:spApi.notifies[campId]['kkbSettings'],socialProofSettings:spApi.notifies[campId]['socialProofSettings']});});},campId);},getPositionOfTheCamp:function(locationConfig,cssConfig){},showTrigger:function(campId,settings){},getTriggerPosition:function(data,fixed){},setTrigger:function(settings,callback){},showSmartFeed:function(camp){},showCamp:function(camp,viewType)
{},checkConditionNeed:function(camp){if(typeof camp=='undefined'||camp==null){return false;}
if(typeof camp.isBounce!=='undefined'&&camp.isBounce=='1'){return true;}
if(typeof camp.conditionNeeds!=='undefined'&&((typeof camp.conditionNeeds.bounce!=='undefined'&&camp.conditionNeeds.bounce=='1')||(typeof camp.conditionNeeds.scroll!=='undefined'&&camp.conditionNeeds.scroll=='1'))){return true;}
return false;},getTime:function(){return Math.round(new Date()/1000+3600);},getUTCTime:function(){var now=new Date();var time=now.getTime();var offset=now.getTimezoneOffset()*60000;return Math.round((time-offset)/1000);},showRsvp:function(){},isRefContains:function(data)
{var res=document.referrer.indexOf(data)>-1;return res;},hasText:function(selectedText,comparedText){try{if(typeof selectedText!=="undefined"&&selectedText!==null){return selectedText.indexOf(comparedText)>-1?true:false;}else{return false;}}catch(err){spApi.errLog(err,{logType:'hasText',bugType:'partner',extraData:{param1:selectedText,param2:comparedText}});}},hasParameter:function(name,exactMatch)
{try{if(typeof exactMatch==="undefined")
exactMatch=false;try{var uri=decodeURI(window.location.href);}catch(err){var uri=unescape(window.location.href);}
if(exactMatch==false){name=decodeURI(name.replace(/[\[\]\/\?]/g,"\\$&"));var regex=new RegExp(name);var results=regex.exec(uri);if(results==null){return false}else
return true;}else if(exactMatch==true){var pageUrl=window.location.href.replace('www.','');if(pageUrl==name){return true;}else{return false;}}}catch(err){spApi.errLog(err,{logType:'hasParameter',bugType:'product',extraData:{param1:name,param2:exactMatch}});}},checkCampaignLanguage:function(camp){if(camp.lang=='all_ALL'||sQuery.inArray(camp.productType,[32,39,47])>-1){return true;}
return spApi.getLang()==camp.lang;},addZeroToUtcHours:function(hour){if(hour<10){hour="0"+hour;}
return hour;},checkDailyDisplay:function(camp){try{var currentDate=new Date();var utcCurrentTime=spApi.addZeroToUtcHours(currentDate.getUTCHours())+':'+currentDate.getUTCMinutes();var utcCurrentDay=spApi.getUTCDayString(currentDate.getUTCDay());var dailyDisplay=camp.dailyDisplay;if(typeof dailyDisplay==='undefined'||!dailyDisplay.length>0){return true;}
dailyDisplay=JSON.parse(dailyDisplay);if(typeof dailyDisplay==='object'){if(sQuery.inArray('all',dailyDisplay.days)>-1||sQuery.inArray(utcCurrentDay,dailyDisplay.days)>-1){return utcCurrentTime>dailyDisplay.start&&utcCurrentTime<dailyDisplay.end;}}
return false;}catch(err){spApi.errLog(err,{logType:'dailyDisplay',bugType:'product'});return false;}},getUTCDayString:function(dayIndex){var weekDay=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return weekDay[dayIndex];},deviceDetect:function(targetDevice){if(targetDevice=='All')return true;var userAgent=navigator.userAgent.toLowerCase();var isMobile=(/iphone|ipod|android|blackberry|opera mini|opera mobi|skyfire|maemo|windows phone|palm|iemobile|symbian|symbianos|fennec/i.test(userAgent));var isTablet=(/(?!.*tablet pc)(ipad|android|sch-i800|playbook|tablet|kindle|gt-p1000|sgh-t849|shw-m180s|a510|a511|a100|dell streak|silk)/i).test(userAgent);if(userAgent.toLowerCase().indexOf('android')>-1){isTablet=isTablet&&userAgent.indexOf('mobile')==-1;isMobile=isMobile&&userAgent.indexOf('mobile')!=-1;}
var device='PC';if(isMobile){device='Mobil';}else if(isTablet){device='Tablet';}
return device==targetDevice;},isOnPanel:function(){try{return window.self!==window.top;}catch(err){spApi.errLog(err,{logType:'isOnPanel',bugType:'partner',extraData:{}});}},getParameter:function(name)
{name=name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");var regexS="[\\?&#]"+name+"=([^&#]*)";var regex=new RegExp(regexS);var results=regex.exec(window.location.href);if(results==null){return"";}else{try{return decodeURIComponent(results[1].replace(/\+/g," "));}catch(err){spApi.errLog(err);return unescape(results[1].replace(/\+/g," "));}}},isParameter:function(name)
{var parameter=spApi.getParameter(name);return(parameter!="")?true:false;},getUserData:function(dataType)
{try{if(dataType=="gender"){if(JSON.parse(localStorage.getItem('spUserData'))[dataType].toLowerCase()=="erkek"){return"male";}else if(JSON.parse(localStorage.getItem('spUserData'))[dataType].toLowerCase()=="kadın"||JSON.parse(localStorage.getItem('spUserData'))[dataType].toLowerCase()=="kadin"){return"female";}else{return JSON.parse(localStorage.getItem('spUserData'))[dataType];}}else{return JSON.parse(localStorage.getItem('spUserData'))[dataType];}}catch(err){spApi.errLog(err,{logType:'getUserData',bugType:'product',extraData:{param1:dataType}});}},setSessionStorage:function(storageName,storeValue)
{spApi.sessionStorageSet(storageName,JSON.stringify(storeValue));},getSessionStorage:function(storageName)
{try{return JSON.parse(spApi.sessionStorageGet(storageName))}catch(err){spApi.errLog(err);spApi.setSessionStorage(storageName,'');return[];}},updateCookie:function(data,type){try{type=typeof type!=='undefined'?type:"general";var campId;if(data.campId)
campId=data.campId;var cookieExpireDate=14;if(typeof campId!=='undefined'){var controlCamp=spApi.getCamp(campId);if(typeof controlCamp.camp!=='undefined'){cookieExpireDate=parseInt(controlCamp.camp.cookieTime);}else if(typeof spApi.webPushes[campId]!=='undefined'){cookieExpireDate=parseInt(spApi.webPushes[campId].cookieTime);}}
var isLocalstorage=false;var localStorageList=['sp-camp','ins-insight','sp-goal','user-segments','paid-products','ins-wp','prodCats'];sQuery.each(localStorageList,function(index,keyName){if(data.key.indexOf(keyName)>-1){isLocalstorage=true;}});c=(isLocalstorage&&spApi.storageData(data.key)!=null)?spApi.storageData(data.key):sQuery.cookie(data.key);if(data.key.indexOf('sp-camp-')>-1&&spApi.salesSesId!=spApi.Base64.encode('0')){if(c==null){data.obj.salesSesId=spApi.Base64.decode(spApi.salesSesId);data.obj.salesSesTime=spApi.getTime();}}
newC=data.obj;if(data.key=='user-segments'){var cookieExpireDate=new Date();cookieExpireDate.setTime(cookieExpireDate.getTime()+(60*60*1000));}
if(data.obj['step1-displayed']){data.obj.viDa=spApi.getTime();}else if(data.obj['joined']||data.obj['liked']){data.obj.joDa=spApi.getTime();}else if(data.obj['closed']){data.obj.clDa=spApi.getTime();}
if(c){if(data.key=='sp-notes'){sQuery.cookie(data.key,c,{path:'/',expires:cookieExpireDate,domain:cookieDomain});}else{oldC=JSON.parse(c);newC=sQuery.extend(true,oldC,newC);if(!isLocalstorage){sQuery.cookie(data.key,sQuery.toJSON(newC),{path:'/',expires:cookieExpireDate,domain:cookieDomain});}else{spApi.storageData(data.key,sQuery.toJSON(newC),{path:'/',expires:cookieExpireDate,domain:cookieDomain});}}}else{if(data.key=='sp-notes'){sQuery.cookie(data.key,data.obj,{path:'/',expires:cookieExpireDate,domain:cookieDomain});}else{if(!isLocalstorage){sQuery.cookie(data.key,sQuery.toJSON(data.obj),{path:'/',expires:cookieExpireDate,domain:cookieDomain});}else{spApi.storageData(data.key,sQuery.toJSON(data.obj),{path:'/',expires:cookieExpireDate,domain:cookieDomain});}}}
if(type!="AB"&&data.key!='sp-notes'&&type!="nolog"){this.worker.check(JSON.parse(c),newC,campId);}}catch(err){spApi.errLog(err,{logType:'updateCookie',bugType:'product',extraData:{param1:data,param2:type}});}},isAudienceProduct:function(campId){var paaProductIds=['32','39','40','47'];return typeof campId!=='undefined'&&typeof spApi.getCamp(campId).camp!=='undefined'&&paaProductIds.indexOf(spApi.getCamp(campId).camp.productType)>-1;},setCookie:function(data,callback){this.worker.cookie(data,callback);},isFreqRule:function(rule){try{return rule.test.indexOf("getMinutes")<0?false:true;}
catch(err){spApi.errLog(err);return false;}},validateEmail:function(email,limit){if(!email){return false;}
if(!limit){var emailReg=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;}else{var emailReg=/^([\w-\.]+@([\w-]+\.)+[\w-]{3,4})?$/;}
if(emailReg.test(email)){return true;}
return false;},reformatDate:function(date,withTimeString){try{date=date||'';if(!date||date.length<10)
return date;date=date.toString();var mappedText=date;if(date.replace(/[0-9]/g,"").length===0){if(date.length==10){date=parseInt(date*1000);}
var date=new Date(parseInt(date));mappedText=date.getFullYear()+'-'+("00"+(date.getMonth()+1)).substr(-2,2)+'-'+("00"+date.getDate()).substr(-2,2);if(withTimeString){mappedText=mappedText+' '+("00"+date.getHours()).substr(-2,2)+':'+("00"+date.getMinutes()).substr(-2,2)+':'+("00"+date.getSeconds()).substr(-2,2);}}
else{date=date.replace(/[^0-9]/g,"-");mappedText=date;var splitDate=date.split('-');if(splitDate.length!==3)
return'';if(splitDate[0].length<4){mappedText=splitDate[2]+'-'+splitDate[1]+'-'+splitDate[0];}}
return mappedText;}catch(err){spApi.errLog(err,{logType:'reformatDate',bugType:'product'});}},hashCode:function(str){var hash=0;if(str.length===0){return hash;}
for(var i=0;i<str.length;i++){var char=str.charCodeAt(i);hash=((hash<<5)-hash)+char;hash=hash&hash;}
return Math.abs(hash);},widgets:{},spCampCheckStatus:function(id,condition){try{if(typeof(id)=='undefined'||id=='undefined')return false;var c=spApi.storageData('sp-camp-'+id);var id=id.toString();if(!c||id=='undefined')
return false;else{var controlCamp=spApi.getCamp(id);c=JSON.parse(c);var status=(condition=="liked")?(c["liked"]||c["closed"]):(c[condition]==true?true:false);if(condition=="liked"||condition=="joined"){tempId=id.toString();if(tempId.indexOf('c')<0){controlCamp=controlCamp.camp;var closeLimitStatus=false;var joinLimitStatus=false;if(c["joDa"]!=undefined){joinLimitStatus=joinLimitStatus=c["joDa"]+controlCamp.joinControlLimit*60*60>spApi.getTime();}
if(c["clDa"]!=undefined){closeLimitStatus=c["clDa"]+controlCamp.closeControlLimit*60*60>spApi.getTime();}
status=status&&(closeLimitStatus||joinLimitStatus);}}else if(condition=="closed"&&c["clDa"]!=undefined){status=status&&c["clDa"]>spApi.getTime()-controlCamp.closeControlLimit*60*60;}
if(typeof status==='string'){return status=="";}else{return status==true;}}}catch(err){spApi.errLog(err,{logType:'spCampCheckStatus',bugType:'product',extraData:{param1:id,param2:condition}});}},getStandardLogData:function(){var data={originalPrice:spApi.getExchangeRate(spApi.preferredCurrency,sQuery.cookie('current-currency'),sQuery.cookie('total-cart-amount'),'price'),originalCurrency:(sQuery.cookie('current-currency')!=null)?sQuery.cookie('current-currency'):'',convertedCurrency:spApi.preferredCurrency,convertedPrice:(sQuery.cookie('total-cart-amount')!=null)?sQuery.cookie('total-cart-amount'):'',sessionId:spApi.salesSesId};return data;},setSaLog:function(id,condition,sendLog){if(sendLog!==false&&window.spSalesOk==1)return;window.spSalesOk=1;var orderID=(spApi.getOrderId()!=undefined&&spApi.getOrderId()!=null&&spApi.getOrderId()!='')?spApi.getOrderId():'ins_unknown_'+Math.random().toString(36).substr(2,5)+'_'+spApi.getTime();var salesOrderId=sQuery.cookie("salesOrderId");if(salesOrderId!=null&&salesOrderId==orderID){return;}else{sQuery.cookie("salesOrderId",orderID,{path:'/',domain:cookieDomain});}
var cookies=spApi.allStorageData();var joinSalesEnable=false;var joinDate=false;var viewDate=false;var bSP=1333411200;var lastJoinDate=lastViewDate=bSP;var logObj=new Object();var lastCookieForCatch='';sQuery.each(cookies,function(i,obj){var cookieKey=obj.key;var value=unescape(obj.value);try{if(cookieKey.indexOf("sp-camp")!=-1){if(value.indexOf("joined")!=-1||value.indexOf("liked")==-1||value.indexOf("step1-displayed")!=-1){lastCookieForCatch=value;var logType='bounce-sales';var cookieContent=JSON.parse(value);if(value.indexOf("joined")!=-1||value.indexOf("liked")!=-1){logType='sales';joinSalesEnable=true;joinDate=typeof cookieContent.joDa!=='undefined'?cookieContent.joDa:bSP;}else if(joinSalesEnable){return;}else{viewDate=bSP;if(cookieContent!=null&&cookieContent.viDa!=='undefined'){viewDate=cookieContent.viDa;}}
if(joinSalesEnable&&joinDate>=lastJoinDate){lastJoinDate=joinDate;logObj=setLogVariable(cookieKey,cookieContent,logType);}else if(!joinSalesEnable&&viewDate>=lastViewDate){lastViewDate=viewDate;logObj=setLogVariable(cookieKey,cookieContent,logType);}}}}catch(err){spApi.errLog(err,{logType:'setSaLog',bugType:'product',extraData:{param1:lastCookieForCatch}});}});if(typeof spApi.setInsightSalesLog==='function'){spApi.setInsightSalesLog(orderID);}
if(typeof spApi.setVersusSalesLog==='function'){spApi.setVersusSalesLog(orderID);}
spApi.setPushSalesLog(orderID);spApi.sendJourneyEmailJoinLog();function setLogVariable(cookie,cookieContent,logType){var logObj=new Object();id=cookie.split("-");if(id[2].indexOf("c")>=0){logObj.id=Number(id[2].replace("c",""));logObj.productType="custom";logObj.salesProductType=20;}else{logObj.id=Number(id[2]);logObj.productType="other";logObj.salesProductType=logObj.productType;}
logObj.type="";logObj.coupon=cookieContent.c;logObj.amount=sQuery.cookie('total-cart-amount');logObj.products=spApi.storageData('paid-products');logObj.logType=logType;return logObj;}
if(sendLog===false)return logObj;try{sQuery.each(spApi.personalizationCamps,function(key,prsnlztn){if(typeof prsnlztn=='undefined'){return;}
sQuery.each(prsnlztn.variations,function(varIdKey,variation){if(typeof variation=='undefined'){return;}
if(typeof spApi['camp'+variation.varId]!=='undefined'&&spApi['camp'+variation.varId].productType==31){return;}
if(spApi.spCampCheckStatus(variation.varId,"step1-displayed")){if(typeof spApi.getCamp(variation.varId).camp!=='undefined'&&typeof spApi.getCamp(variation.varId).camp.saLogDuration!=='undefined'){var campSaLogDuration=spApi.getCamp(variation.varId).camp.saLogDuration;}else{var campSaLogDuration=336;}
var viDa=sQuery.parseJSON(spApi.storageData('sp-camp-'+variation.varId)).viDa;viDa=new Date(viDa*1000);viDa.setHours(viDa.getHours()+campSaLogDuration);if(viDa>spApi.getTime()){var logParams={campId:variation.varId,referer:encodeURIComponent(logObj.amount),ref:window.document.referrer,url:window.document.URL,productType:(spApi.getCamp(variation.varId).camp.productType=="20")?("custom"):("other"),multivariateGroup:key,orderId:orderID,paidProducts:logObj.products,sessionId:spApi.salesSesId,salesSesId:spApi.getCampSalesSesInfo(variation.varId,'salesSesId',spApi.getCamp(variation.varId).camp.productType),salesSesTime:spApi.getCampSalesSesInfo(variation.varId,'salesSesTime',spApi.getCamp(variation.varId).camp.productType)+'-'+spApi.getTime(),appliedCode:spApi.getAppliedCode(variation.varId),salesType:'variation-sales',paaRoiGroup:sQuery.parseJSON(spApi.storageData('sp-camp-'+variation.varId)).paaRoiType,paaProductType:spApi.getCamp(variation.varId).camp.productType};logParams=sQuery.extend(logParams,spApi.getStandardLogData());spApi.worker.send('sales-log',logParams);}}});});}catch(e){spApi.errLog(e,{logType:'setLogVariable (variation-sales) ',bugType:'product'});spApi.conLog('personalizationCamps log error');spApi.conLog(e);}
if(id){var referrer=encodeURIComponent(logObj.coupon+"|-|"+logObj.amount);var saleCampId=(logObj.productType=="custom")?('c'+logObj.id):(logObj.id);if(typeof spApi.getCamp(saleCampId).camp!=='undefined'&&typeof spApi.getCamp(saleCampId).camp.saLogDuration!=='undefined'){var campSaLogDuration=spApi.getCamp(saleCampId).camp.saLogDuration;}else{var campSaLogDuration=336;}
var campNameString=(logObj.productType=="custom"&&typeof logObj.id==='number')?"sp-camp-c"+logObj.id:"sp-camp-"+logObj.id;var viDa=JSON.parse(spApi.storageData(campNameString)||sQuery.cookie(campNameString)).viDa;viDa=new Date(viDa*1000);viDa.setHours(viDa.getHours()+campSaLogDuration);if((logObj.logType!='sales'&&logObj.logType!='bounce-sales')||viDa>spApi.getTime()){var logParams={campId:logObj.id,referer:referrer,ref:window.document.referrer,url:window.document.URL,productType:logObj.productType,paidProducts:logObj.products,sessionId:spApi.salesSesId,salesSesId:spApi.getCampSalesSesInfo(logObj.id,'salesSesId',logObj.salesProductType),salesSesTime:spApi.getCampSalesSesInfo(logObj.id,'salesSesTime',logObj.salesProductType)+'-'+spApi.getTime(),appliedCode:spApi.getAppliedCode(logObj.id),orderId:orderID,salesType:logObj.logType+logObj.type};logParams=sQuery.extend(logParams,spApi.getStandardLogData());this.worker.send('sales-log',logParams);}}
var logParams={type:'sa-co',orderId:orderID,paidProducts:(spApi.storageData('paid-products')!=null)?spApi.storageData('paid-products'):'',sessionId:spApi.salesSesId,salesSesId:spApi.getCampSalesSesInfo(logObj.id,'salesSesId',logObj.salesProductType),salesSesTime:spApi.getCampSalesSesInfo(logObj.id,'salesSesTime',logObj.salesProductType)+'-'+spApi.getTime(),referer:encodeURIComponent("notavailable"+"|-|"+sQuery.cookie('total-cart-amount')),ref:window.document.referrer,globalExperiment:(spApi.storageData("globalExperimentRate")!=null)?1:0,globalExperimentType:(spApi.storageData("globalExperimentRate")!=null&&JSON.parse(spApi.storageData("globalExperimentRate"))['assign']=='A')?'variation-sales-A':'variation-sales-B',campId:0};logParams=sQuery.extend(logParams,spApi.getStandardLogData());this.worker.send('do-logging',logParams);return logObj;},isMobileBrowser:function(){(function(a){sQuery.browser.mobile=/android.+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))})(navigator.userAgent||navigator.vendor||window.opera);if((/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||sQuery.browser.mobile)){if(typeof window.isMobileBrowser=='undefined'){spApi.consoleLog.push('API is steady for mobile devices.');window.isMobileBrowser=true;}
return true;}else{return false;}},isAndroid:function(){return navigator.userAgent.toLowerCase().indexOf('android')>-1;},getAndroidVersion:function(){var match=navigator.userAgent.toLowerCase().match(/android\s([0-9\.]*)/);return match?match[1]:-1;},shouldShowPushPermissionDialog:function(){return!(spApi.isAndroid()&&parseInt(spApi.getAndroidVersion(),10)>=7&&spApi.getBrowser()==='Samsung Internet'&&parseInt(spApi.getBrowser(true))===6);},isMobileCamp:function(campaign){var status=false;if(typeof campaign!='undefined'){if(campaign.platform==='mobile'&&!spApi.deviceDetect('Tablet')){status=true;}else if(spApi.isMobileBrowser()){status=(campaign.productType=='30')?true:status;}}
return status;},isTabletCamp:function(campaign){return campaign.platform==='tablet';},isAllPagesCamp:function(campaign){return campaign.platform==='all';},showNotes:function(data,fromJoin,fromPurcha){if(typeof window.spInit=="undefined"){try{var notesDate=new Date();var fromJoin=typeof fromJoin!=='undefined'?fromJoin:false;var fromPurcha=typeof fromPurcha!=='undefined'?fromPurcha:false;notesDate.setTime(notesDate.getTime()+(14*24*60*60*1000));var removeAssistantCookie=function(){sQuery.cookie('sp-notes',null,{expires:notesDate,path:'/',domain:cookieDomain});sQuery.cookie('ins-adp-assist',null,{expires:notesDate,path:'/',domain:cookieDomain});};if(this.notes)
notes=JSON.parse(this.notes);else
notes={};if(spApi.isOnAfterPaymentPage()==true){notes={};this.displayNotes=0;removeAssistantCookie();}
if(data){data=data.split("|");camp=spApi.getCamp(data[1]).camp;if(!camp.isActive||camp.showNotes=="")
return false;if(camp.showNotes!=""&&camp.showNotes!=undefined&&camp.showNotes.length>0){notes[data[0]]=camp.couponExpDate+"#"+camp.showNotes+"#"+camp.couponAutoApply;sQuery.cookie('sp-notes',2+'|'+sQuery.toJSON(notes),{expires:notesDate,path:'/',domain:cookieDomain});this.displayNotes=2;}
if(this.displayNotes==undefined){this.displayNotes=2;}}
var couponAsistantShowControl=1;if(sQuery.cookie('couponAsistantShowed')!=null&&Number(sQuery.cookie('couponAsistantShowed'))==1){couponAsistantShowControl=0;}
if(!fromJoin&&(this.displayNotes==1||this.displayNotes==2||this.displayNotes==3)&&couponAsistantShowControl){sQuery(document).ready(function(){i=0;var lang={};lang["en"]={};lang["en"]["coupAssitCode"]="Your Coupon";lang["en"]["coupAssitCopy"]="Copy";lang["en"]["coupAssitCopyMsg"]="Your Coupon Copied";lang["en"]["coupAssitCopyMsgBody"]="You can activate your coupon by pasting on coupon area in basket page.";lang["tr"]={};lang["tr"]["coupAssitCode"]="Kupon Kodunuz";lang["tr"]["coupAssitCopy"]="Kopyala";lang["tr"]["coupAssitCopyMsg"]="Kupon kodunuz kopyaland&#305";lang["tr"]["coupAssitCopyMsgBody"]="&#214;deme sayfas&#305;nda kupon alan&#305;na yap&#305;&#351;t&#305;rarak indiriminizi etkinle&#351;tirin.";lang["ru"]={};lang["ru"]["coupAssitCode"]="&#1050;&#1086;&#1076; &#1050;&#1091;&#1087;&#1086;&#1085;&#1072;";lang["ru"]["coupAssitCopy"]="&#1050;&#1086;&#1087;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100;";lang["ru"]["coupAssitCopyMsg"]="&#1053;&#1072; &#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;&#1077; &#1086;&#1092;&#1086;&#1088;&#1084;&#1083;&#1077;&#1085;&#1080;&#1103; &#1079;&#1072;&#1082;&#1072;&#1079;&#1072; &#1074;&#1074;&#1077;&#1076;&#1080;&#1090;&#1077; &#1082;&#1086;&#1076; &#1082;&#1091;&#1087;&#1086;&#1085;&#1072; &#1080; &#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1090;&#1077; &#1089;&#1082;&#1080;&#1076;&#1082;&#1091;";lang["pl"]={};lang["pl"]["coupAssitCode"]="Tw&oacute;j Kupon";lang["pl"]["coupAssitCopy"]="Kopiuj";lang["pl"]["coupAssitCopyMsg"]="Tw&oacute;j Kupon zosta&#322; skopiowany";lang["pl"]["coupAssitCopyMsgBody"]="Mo&#380;esz aktywowa&#263; sw&oacute;j kupon poprzez wklejenie jego w miejscu do tego przeznaczonym na stronie zam&oacute;wie&#324;.";var spLang="en";if(spApi.getLang()=="tr_TR"){spLang="tr";}else if(spApi.getLang()=="ru_RU"){spLang="ru";}else if(spApi.getLang()=="pl_PL"){spLang="pl";}
var couponText=new Array();var noteText=new Array();var noteExpDate=new Array();var date=Math.round(+new Date()/1000+3600*1);for(key in notes){couponText[i]=key;if(notes[key].split("#").length!=undefined&&notes[key].split("#").length>1){noteText[i]=notes[key].split("#")[1];noteExpDate[i]=notes[key].split("#")[0];if(noteExpDate[i]>0&&date>=noteExpDate[i]){delete notes[couponText[i]];var assistStatus=2;var notesCount=0;for(key in notes){notesCount++;}
if(!notesCount>0){assistStatus=0;spApi.displayNotes=4;}
sQuery.cookie('sp-notes',assistStatus+'|'+sQuery.toJSON(notes),{expires:notesDate,path:'/',domain:cookieDomain});}}
else{noteText[i]=notes[key];}
i++;}
if(sQuery.cookie('ins-adp-assist')&&i==1){spApi.logger('info','Adaptif kupon asistanı aktif');var adpSettings=JSON.parse(sQuery.cookie('ins-adp-assist'));sQuery("head link[rel='stylesheet']").last().after("<link rel='stylesheet' href='"+spApi.staticUrl+"fonts/fontello/css/fontello.css' type='text/css' media='screen'>");sQuery("head link[rel='stylesheet']").last().after("<link rel='stylesheet' href='"+spApi.apiUrl+"css/adp.css' type='text/css' media='screen'>");var adaptiveHtml='<div id="adaptive-assistant"><div id="adaptive-box"><p id="adaptive-text">'+adpSettings.text+'</p></div><div id="adaptive-assistant-box" style="background-color: '+adpSettings.bgColor+';"><i id="adaptive-icon" class="ins-icon-'+adpSettings.ic+'" style="color: '+adpSettings.color+';"></i></div></div>';sQuery('body').append(adaptiveHtml);sQuery('#adaptive-icon').die('click').live('click',function(){sQuery('#adaptive-box').toggleClass('display-table');});}
else if(sQuery('#sp-notes').length<=0){spApi.logger('info','Kupon asistanı aktif');sQuery('body').append('<div id="sp-notes"><div class="sp-notes-pop"><a href="javascript:;" class="sp-notes-pop-close"></a><strong id="coupAssitCopyMsg"></strong><br><div id="coupAssitCopyMsgBody"></div></div><div class="sp-title">Kupon Kodunuz</div><a href="javascript:;" class="sp-noteMin"></a><a href="javascript:;" class="sp-noteClose"></a><div class="sp-couponHolder"><a href="javascript:;" class="sp-notePrev"></a><span id="scissor2"></span><div class="sp-coupon"></div><a href="javascript:;" class="sp-noteNext"></a><a href="javascript:;" style="display:none;width:100%;text-align:center;" class="sp-copy"></a></div><div class="sp-note"></div><div class="product-footer"><div class="marka-logo"><img src="//almosafernew.img.sociaplus.com/" /></div><div class="socia-logo"><img src="'+spApi.apiUrl+'images/pw_65x13.png" /></div></div></div>');}
sQuery('.sp-title').html(lang[spLang]["coupAssitCode"]);sQuery('.sp-copy').html(lang[spLang]["coupAssitCopy"]);sQuery('#coupAssitCopyMsg').html(lang[spLang]["coupAssitCopyMsg"]);sQuery('#coupAssitCopyMsgBody').html(lang[spLang]["coupAssitCopyMsgBody"]);sQuery('.sp-coupon').html(couponText[i-1]);sQuery('.sp-note').html(noteText[i-1]);sQuery('.sp-noteB').unbind("click").click(function(e){e.preventDefault();});if(i>1){sQuery(".sp-notePrev, .sp-noteNext").unbind("click").css("display","block");var j=i-1;sQuery('.sp-noteNext').die('click').live('click',function(e){sQuery('#sp-notes').fadeOut(50).delay(50).fadeIn(50,function(){sQuery('.sp-coupon').html(couponText[j]);sQuery('.sp-note').html(noteText[j]);});j++;if(j>=i)
j=0;});sQuery('.sp-notePrev').die('click').live('click',function(e){sQuery('#sp-notes').fadeOut(50).delay(50).fadeIn(50,function(){sQuery('.sp-coupon').html(couponText[j]);sQuery('.sp-note').html(noteText[j]);});j--;if(j<=-1)
j=i-1;});}
if(sQuery('#sp-notes').length>0){if(sQuery.trim(sQuery('.sp-coupon').text())=="")
removeAssistantCookie();if((spApi.displayNotes==2||spApi.displayNotes==3)&&sQuery.trim(sQuery('.sp-coupon').text())!=""){var bottom=0;if(spApi.displayNotes==3){sQuery('#sp-notes').css("bottom",bottom+"px");}
else{setTimeout(function(){sQuery('#sp-notes').animate({bottom:bottom+"px"},1500);sQuery.cookie('sp-notes',3+'|'+sQuery.toJSON(notes),{expires:notesDate,path:'/',domain:cookieDomain});},1000);}}
else if(spApi.displayNotes==4){sQuery('#sp-notes').hide();}
else{if(sQuery.trim(sQuery('.sp-coupon').text())==""){sQuery('#sp-notes').hide();}
else{var noteHeight=sQuery('#sp-notes').height();var titleHeight=sQuery('#sp-notes .sp-title').height()+10;var bottomAnimate=(noteHeight-titleHeight)*-1;var bottom=bottomAnimate;}}}
sQuery('.sp-noteClose').die('click').live('click',function(){sQuery('#sp-notes').fadeOut();setSessionOnlyCookie('couponAsistantShowed','1');if(JSON.parse(localStorage.getItem('couponAsistantLog'))==null){if(spApi.isOnCartPage())
ref=1;else
ref=document.location.href;spApi.worker.send('couponAssitantLog',{type:'closeCouponAssist',campId:'',referer:ref});localStorage.setItem('couponAsistantLog',JSON.stringify('1'));}});if(Boolean(spApi.couponAsistanceShowEvents)){sQuery.each(spApi.couponAsistanceShowEvents,function(key,callback){callback();});}
sQuery('.sp-noteMin, .sp-title').die('click').live('click',function(){if(spApi.displayNotes==3){sQuery.cookie('sp-notes',1+'|'+sQuery.toJSON(notes),{expires:notesDate,path:'/',domain:cookieDomain});var noteHeight=sQuery('#sp-notes').height();var titleHeight=sQuery('#sp-notes .sp-title').height()+10;var bottomAnimate=(noteHeight-titleHeight)*-1;sQuery('#sp-notes').animate({bottom:bottomAnimate+"px"},400);spApi.displayNotes=1;}
else{sQuery.cookie('sp-notes',3+'|'+sQuery.toJSON(notes),{expires:notesDate,path:'/',domain:cookieDomain});sQuery('#sp-notes').animate({bottom:"0"},400);spApi.displayNotes=3;}});var browser=spApi.getBrowser();if(browser!="Safari"&&browser!="Firefox"){sQuery.ajaxSetup({cache:true});var pluginSrc=spApi.apiUrl+'js/jquery.zclip-light.min.js';if(!('ZeroClipboard'in window)){pluginSrc=spApi.apiUrl+'js/jquery.zclip.min.js';}
sQuery.getScript(pluginSrc).done(function(){try{sQuery('.sp-copy').show();sQuery('.sp-copy').zclip({path:spApi.apiUrl+'js/ZeroClipboard.swf',copy:function(){return sQuery('.sp-coupon').text();},afterCopy:function(){sQuery('.sp-notes-pop').show();if(spApi.isOnCartPage()){ref=1;}else{ref=document.location.href;}
spApi.worker.send('couponAssitantLog',{type:'copyCoupon',campId:'',referer:ref});}});sQuery('.sp-copy').css("visibility","visible");}catch(err){spApi.errLog(err,{logType:'ZeroClipBoard Version Conflict Error',bugType:'product'});}});sQuery.ajaxSetup({cache:false});}
var hasFlash=false;try{var fo=new ActiveXObject('ShockwaveFlash.ShockwaveFlash');if(fo){hasFlash=true;}}
catch(e){if(navigator.mimeTypes&&navigator.mimeTypes['application/x-shockwave-flash']!=undefined&&navigator.mimeTypes['application/x-shockwave-flash'].enabledPlugin){hasFlash=true;}}
if(hasFlash==false){sQuery('.sp-copy').remove();sQuery('.zclip').remove();}
sQuery('.sp-notes-pop-close').click(function(){sQuery(this).parent(0).hide();});});}}catch(err){spApi.errLog(err);}
window.spInit=1;}},noteTimer:function(data){},gaSend:function(l,caller){},getGAStyleSesId:function(){var id=sQuery.cookie('ins-gaSSId');try{spApi.logger('info','set gaStyleSession id ');var sessionInit=false;var expDate=new Date();expDate.setTime(expDate.getTime()+(30*60*1000));var cookieSettings={expires:expDate,path:'/',domain:cookieDomain};var isSessionExpired=!id;if(!isSessionExpired){var oldSession=/.+_(.*)/.exec(id);if(oldSession&&oldSession.length==2){isSessionExpired=(new Date((oldSession[1]-3600)*1000)).getUTCDate()!=(new Date()).getUTCDate();}}
if(isSessionExpired){spApi.logger('info','update gaStyleSession id !');sessionInit=true;function guid(){function s4(){return Math.floor((1+Math.random())*0x10000).toString(16).substring(1);}
return s4()+s4()+'-'+s4()+'-'+s4()+'-'+
s4()+'-'+s4()+s4()+s4();}
id=guid()+'_'+spApi.getTime();var pairs=spApi.allStorageData();sQuery.each(pairs,function(i,obj){var key=obj.key;if(key.indexOf("ins-insight-")!=-1){var logData={key:sQuery.trim(key),obj:sQuery.toJSON(null)};spApi.updateCookie(logData,'nolog');}});}
if(typeof spApi.sessionInit==='undefined'){spApi.sessionInit=sessionInit;}
sQuery.cookie('ins-gaSSId',id,cookieSettings);}catch(err){spApi.errLog(err,{logType:'getGAStyleSesId',bugType:'partner'});}
return id;},cartCatCount:function(_cat){try{if(!spApi.isOnCartPage())return;var success=false;var count=0;var products=spApi.getPaidProducts()||[];var prodCats=JSON.parse(spApi.storageData('prodCats'))||[];if(typeof products=="undefined"||typeof prodCats=="undefined"||products.length==0||prodCats.length==0)return count;sQuery.each(products,function(i,product){success=false;sQuery.each(prodCats,function(j,cat){if(sQuery.trim(decodeURIComponent(cat.name))==sQuery.trim(product.name)&&cat.cat.toLowerCase().indexOf(_cat.toLowerCase())!=-1){success=true;return false;}});if(success)count++;});return count;}catch(err){spApi.errLog(err,{logType:'cartCatCount',bugType:'partner',extraData:{param1:_cat}});}},getCamp:function(campId){if(typeof this.sortCamp=="undefined"){this.sortCamp={};var me=this;sQuery.each(spApi.camps.concat(spApi.customizationCamps),function(key,camp){me.sortCamp[camp.id]=camp;});}
var campObject={};campObject.camp=this.sortCamp[campId];return campObject;},setApiInitConditions:function(data){try{sQuery(data).each(function(index,eventList){sQuery.each(eventList,function(type,eventData){if(type=="standard"){var actions=['click','keydown','keyup'];if(actions.indexOf(eventData.event)>-1&&typeof window.apiInitEvent==='undefined'){sQuery(eventData.selectorString).live(eventData.event,function(e){setTimeout(function(){if(spApi.e(eventData.condition)){spApi.reInitOnChange();}},eventData.timeout||500);window.apiInitEvent=true;});}}else if(type=="urlChange"){var url=location.href;var urlTimer=setInterval(function(){if(location.href!=url){url=location.href;spApi.reInitOnChange();}},500);}});});}catch(err){spApi.errLog(err,{logType:'setApiInitConditions',bugType:'partner',extraData:{paramer:''}});}},reInitOnChangeCallbacks:[],reInitOnChange:function(){try{spApi.reInitOnChangeCallbacks.forEach(function(callback){callback()});if(sQuery.fancybox){var sliderCampList=[];var pairs=spApi.allStorageData();sQuery.each(pairs,function(i,obj){var key=obj.key;var value=unescape(obj.value);if(key.indexOf('sp-camp-')==-1)return;if(typeof spApi.notifies[key.match(/\d+/g)[0]]=="undefined")return;if(spApi.notifies[key.match(/\d+/g)[0]].category!="7")return;if(value.indexOf('hideSlider')!=-1)return;sliderCampList.push(key.match(/\d+/g)[0]);});sQuery.fancybox.close();sQuery('.sp-inner-notification').remove();sQuery('.sp-inline-wrap').remove();sQuery('.ins-crowdy-wrap').remove();sQuery('.ins-preview-wrapper').remove();sQuery.each(sliderCampList,function(key,campId){var campCookie=JSON.parse(spApi.storageData('sp-camp-'+campId));if(campCookie!=null){delete campCookie.hideSlider;spApi.storageData('sp-camp-'+campId,JSON.stringify(campCookie),{expires:14,path:'/',domain:cookieDomain});}});}
spApi.conLog('init');spApi.clearCustomCamps();spApi.personalizationSetStatus=false;spApi.sessionInit=undefined;spApi.activeBannerManagementCamps=[];spApi.hitSend=false;spApi.init(false);spApi.executedCallbacks=[];}catch(err){spApi.errLog(err,{logType:'reinitOnParameterChange',bugType:'partner',extraData:{paramer:location.href}});}},isTargetingReady:function(camp){var builderId=spApi.getBuilderIdFromVar(camp.id);return camp.isTest!=1||(camp.isTest==1&&builderId in spApi.getCampBuilderCandidates());},getPersonalizationCamp:function(){if(!spApi.personalizationSetStatus){spApi.personalizationSetStatus=true;}else{return;}
spApi.userSegments=spApi.storageData("user-segments")==null?{}:sQuery.parseJSON(spApi.storageData("user-segments"));var newSegmentList=new Object();sQuery.each(spApi.personalizationCamps,function(prsnlztnId,prsnlztn){if(typeof prsnlztn=='undefined'){return;}
if(spApi.userSegments[prsnlztnId]==undefined||typeof spApi.userSegments[prsnlztnId]=='undefined'){try{var isSegmentValid=true;var prsnlztnStatus=false;if(prsnlztn.segment!=undefined&&prsnlztn.segment!=null&&prsnlztn.segment.length>0){if(!spApi.e(spApi.rules[prsnlztn.segment[0]].test)){isSegmentValid=false;}else{delete spApi.userSegments[prsnlztnId];}}}catch(err){spApi.errLog(err,{logType:'getPersonalizationCamp-blok1-'+prsnlztnId,bugType:'partner',extraData:{param1:JSON.stringify(prsnlztn)}});}
var totalRatio=0;var randomRatio=parseInt(Math.random()*100);var displayedVar=false;if(isSegmentValid){sQuery.each(prsnlztn.variations,function(key,variation){try{if(variation!=null&&variation.varId){if(!spApi.spCampCheckStatus(variation.varId,"step1-displayed")){oldRatio=Number(totalRatio);totalRatio+=Number(variation.ratio);if(!displayedVar&&oldRatio<=randomRatio&&randomRatio<totalRatio){spApi.userSegments[prsnlztnId]=variation.varId;newSegmentList[prsnlztnId]={id:variation.varId,ratio:"o:"+oldRatio+" r:"+randomRatio+" t:"+totalRatio+" var ratio:"+variation.ratio};return true;}}else{spApi.userSegments[prsnlztnId]=variation.varId;newSegmentList[prsnlztnId]={id:variation.varId,ratio:"already shown. var ratio:"+variation.ratio};return false;}}}catch(err){spApi.errLog(err,{logType:'getPersonalizationCamp-blok2-'+prsnlztnId,bugType:'partner',extraData:{param1:JSON.stringify(variation)}});}});}}});try{data={key:'user-segments',obj:spApi.userSegments};spApi.updateCookie(data,"nolog");}catch(err){spApi.errLog(err,{logType:'getPersonalizationCamp-blok3',bugType:'partner',extraData:{param1:JSON.stringify(tempSegment)}});}},getPersonalizationId:function(id){var variationCampId;try{sQuery.each(spApi.personalizationCamps,function(campId,prsnlztn){if(typeof prsnlztn=='undefined'){return;}
sQuery.each(prsnlztn.variations,function(varKey,variation){if(variation.varId==id){variationCampId=campId;}});});return variationCampId;}catch(err){spApi.errLog(err,{logType:'getPersonalizationId',bugType:'partner',extraData:{param1:id}});}},isControlCamp:function(id){var cgStatus=false;sQuery.each(spApi.personalizationCamps,function(campId,prsnlztn){if(typeof prsnlztn=='undefined'){return;}
sQuery.each(prsnlztn.variations,function(varKey,variation){if(typeof prsnlztn=='undefined'){return;}
if(variation.varId==id&&variation.type=="cg"){cgStatus=true;}});});return cgStatus;},checkVarSegment:function(variation){var status=true;sQuery.each(spApi.personalizationCamps,function(prsnlztnId,prsnlztn){if(typeof prsnlztn=='undefined'){return;}
sQuery.each(prsnlztn.variations,function(key,vari){if(typeof prsnlztn=='undefined'){return;}
if(vari&&vari.varId==variation['id']){if(spApi.userSegments[prsnlztnId]==variation['id']){status=true;return true;}else{status=false;return false;}}});});return status;},eventManager:function(elementTarget){var trigger=function(eventStackId,event){event.stopImmediatePropagation();spApi.eventStack[eventStackId].callback();};return{on:function(eventType,delegatedElement,callback,multipleListenerOption){if(!elementTarget){spApi.logger('Specify element to set event on');return false;}
var bubbleOption=false;if(arguments.length===3){bubbleOption=true;if(typeof delegatedElement==='function'){multipleListenerOption=callback;callback=delegatedElement;}}else if(arguments.length===2){callback=delegatedElement;delegatedElement='';}
if(typeof callback!=='function'){spApi.logger('Callback must be a function.');return false;}
var eventStackId=spApi.hashCode(callback.toString());spApi.eventStack[eventStackId]={id:eventStackId,type:eventType,element:delegatedElement,captureElement:elementTarget,callback:callback,listenerOption:multipleListenerOption};var setListenerOnAll=function(){sQuery(elementTarget).on(eventType,delegatedElement,function(event){trigger(eventStackId,event);});sQuery(delegatedElement).on(eventType,function(event){trigger(eventStackId,event);});};var setListenerOnHead=function(){sQuery(elementTarget).on(eventType,delegatedElement,function(event){trigger(eventStackId,event);});};var setListenerOnCurrentElement=function(){sQuery(elementTarget).on(eventType,function(event){trigger(eventStackId,event);});};if(multipleListenerOption){setListenerOnAll();}else if(bubbleOption){setListenerOnHead();}else{setListenerOnCurrentElement();}},triggerEvent:function(type,delegatedElement,manualEventCallback){for(var stackId in spApi.eventStack){if(spApi.eventStack.hasOwnProperty(stackId)){var currentEvent=spApi.eventStack[stackId];var specifiedElement=delegatedElement||'';if(currentEvent.type===type&&currentEvent.captureElement===elementTarget&&currentEvent.element===specifiedElement){currentEvent.callback();(manualEventCallback||function(){}).call();}}}},refresh:function(){for(var stackId in spApi.eventStack){if(spApi.eventStack.hasOwnProperty(stackId)){var currentEvent=spApi.eventStack[stackId];spApi.eventManager(currentEvent.captureElement).on(currentEvent.type,currentEvent.element,currentEvent.callback,currentEvent.listenerOption);}}
spApi.logger('All Events has been refreshed');}}}};Object.setPrototypeOf=Object.setPrototypeOf||function(obj,proto){obj.__proto__=proto;return obj;};Object.setPrototypeOf(spApi,{uidExpireDate:365,eventStack:{},allCamps:spApi.concat(spApi.concat(spApi.camps.concat(spApi.customizationCamps),spApi.webPushes),spApi.customSegments)});spApi.getPrototype=function(key){return spApi.__proto__[key];};spApi.setApiInitConditions([{'urlChange':{'selectorString':false}}]);spApi.objKeys=function(obj){return Object.keys(obj).length>0}
spApi.localStorageGet=function(storageName){try{return localStorage[storageName]||null;}catch(e){return null;}};spApi.localStorageSet=function(storageName,storeValue){try{return localStorage[storageName]=storeValue;}catch(e){return null;}};spApi.localStorageRemoveItem=function(storageName){try{return delete localStorage[storageName];}catch(e){return null;}};spApi.sessionStorageGet=function(storageName){try{return sessionStorage[storageName]||null;}catch(e){return null;}};spApi.sessionStorageSet=function(storageName,storeValue){try{return sessionStorage[storageName]=storeValue;}catch(e){return null;}};spApi.sessionStorageRemoveItem=function(storageName){try{return delete sessionStorage[storageName];}catch(e){return null;}};setEmailToCookie=function(name,value,expire,domain){if(spApi.validateEmail(value)){if(expire===undefined)
expire=365;if(domain===undefined)
domain=cookieDomain;sQuery.cookie(name,value,{expires:expire,path:'/',domain:domain});}};var setUserDataToCookie=(function(userDatas){if(userDatas==false||typeof(userDatas)=='undefined')
return;var cookieName="insUserData";var save=function(createUserData){createUserData=JSON.stringify(createUserData);sQuery.cookie(cookieName,createUserData,{expires:360,path:"/",domain:cookieDomain});spApi.localStorageSet(cookieName,createUserData);}
var createUserData={};sQuery(userDatas.Login.button).live('click',function(){if(!spApi.validateEmail(sQuery(userDatas.Login.email).val()))return;if(sQuery.cookie(cookieName)!==null){var cookieContent=JSON.parse(sQuery.cookie(cookieName));createUserData=cookieContent;}
createUserData.email=sQuery(userDatas.Login.email).val();save(createUserData);});sQuery(userDatas.Register.button).live('click',function(){if(!spApi.validateEmail(sQuery(userDatas.Register.email).val()))return;createUserData.email=sQuery(userDatas.Register.email).val();createUserData.city=sQuery(userDatas.Register.city).val();createUserData.region=sQuery(userDatas.Register.region).val();createUserData.name=sQuery(userDatas.Register.name).val();save(createUserData);spApi.sessionStorageSet('isRegSuccess',1);});})(spApi.setEmailToCookie());spApi.timeOut=function(call,time){return setTimeout(function(){try{call();}catch(err){spApi.errLog(err,{logType:'setTimeout Error',bugType:'partner',extraData:{time:time,callback:call.toString()}});}},time);};spApi.interval=function(call,time){return setInterval(function(){try{call();}catch(err){spApi.errLog(err,{logType:'setInterval Error',bugType:'partner',extraData:{time:time,callback:call.toString()}});}},time);};spApi.ruleControl=function(rule,camp){try{rule.test=rule.test.replace(/setTimeout/g,'spApi.timeOut');rule.test=rule.test.replace(/setInterval/g,'spApi.interval');if(camp.isTest=="1"){return false;}else{return spApi.e(rule.test)===true;}}catch(err){var extraData={campaignName:spApi.decryptCampName(camp.campName),campaignId:camp.id};if(rule){extraData.ruleName=rule.name;extraData.ruleId=rule.id;extraData.ruleContent=rule.test}else{extraData.rule="undefined rule";}
spApi.errLog(err,{logType:'Rule Error',bugType:'partner',extraData:extraData});return false;}};spApi.getGlobalUserIdFromLocalStorage=function(){if(spApi.storageData('insGUID')!=null){return spApi.Base64.decode(spApi.storageData('insGUID'));}
return null;};spApi.campEventControl=function(eventName,callback){try{callback();}catch(err){spApi.errLog(err,{logType:'Campaign Event Error',bugType:'partner',extraData:{event:eventName,callback:callback.toString()}});}};spApi.debugModeOpen=function(){sQuery.cookie('spDebugMode',1,{expires:1,path:'/',domain:cookieDomain});spApi.logger('info','Debug Mode Active');};spApi.debugModeClose=function(){sQuery.cookie('spDebugMode',null,{expires:1,path:'/',domain:cookieDomain});spApi.logger('info','Debug Mode Passive');};spApi.debugModeIsOpen=function(){return sQuery.cookie('spDebugMode')!==null||false;};spApi.conLog=function(){if(spApi.debugModeIsOpen()&&typeof console.log!=='undefined'){console.log.apply(console,arguments);}};spApi.sentHitPayloads={pageView:{}};spApi.logger=function(type,message,campID){try{message=spApi.Base64.encode(message);if(typeof spApi.apiLogs==="undefined"){spApi.apiLogs={'camps':{},'general':[]};}
if(typeof campID!=="undefined"){if(typeof spApi.apiLogs.camps[campID]==="undefined"){spApi.apiLogs.camps[campID]=[];}
var logObject={'campID':campID,'type':type,'message':message,'time':new Date().getTime()};spApi.apiLogs.camps[campID].push(logObject)}
else{var logObject={'campID':campID,'type':type,'message':message,'time':new Date().getTime()};spApi.apiLogs.general.push(logObject)}
if(spApi.debugModeIsOpen()){if(type=='info'&&typeof console.info!=='undefined'){if(typeof campID==="undefined"){console.info(spApi.Base64.decode(message),'Log Time:',logObject.time);}
else{console.info(spApi.Base64.decode(message),'Camp ID:',campID,'Log Time:',logObject.time);}}
else if(type=='warning'&&typeof console.warn!=='undefined'){if(typeof campID==="undefined"){console.warn(spApi.Base64.decode(message),'Log Time:',logObject.time);}
else{console.warn(spApi.Base64.decode(message),'Camp ID:',campID,'Log Time:',logObject.time);}}
else if(type=='error'&&typeof console.error!=='undefined'){if(typeof campID==="undefined"){console.error(spApi.Base64.decode(message),'Log Time:',logObject.time);}
else{console.error(spApi.Base64.decode(message),'Camp ID:',campID,'Log Time:',logObject.time);}}}}
catch(e){spApi.errLog(e);}
return true;}
spApi.getLogs=function(campID){if(typeof spApi.apiLogs==="undefined"||spApi.apiLogs.length<1){return{};}
var logs={'camps':{},'general':[]};sQuery.each(spApi.apiLogs.camps,function(i,l){logs.camps[i]=[];sQuery.each(l,function(k,val){var logObject=sQuery.extend(true,{},val);logObject.message=spApi.Base64.decode(logObject.message);logs.camps[i].push(logObject);});});sQuery.each(spApi.apiLogs.general,function(i,val){var logObject=sQuery.extend(true,{},val);logObject.message=spApi.Base64.decode(logObject.message);logs.general.push(logObject);});if(typeof campID!=="undefined"){if(typeof spApi.apiLogs.camps[campID]!=="undefined"){return logs.camps[campID];}
return false;}
return logs;}
if(spApi.debugModeIsOpen()){spApi.logger('info','Debug Mode Active');}
spApi.addDbLog(null);function processAnalyticsResult(data){if(data&&typeof data.count!="undefined")
{return data.count;}
return 0;}
sQuery.fn.extend({pm:function(pmFunction,success,data){return this.each(function(){if(sQuery(this).is('iframe')){pm({target:sQuery(this)[0].contentWindow,type:'sQueryPM',data:{data:JSON.stringify(data),callback:encodeURI(pmFunction)},success:function(data){if(Boolean(success)){try{success(data);}catch(err){spApi.errLog(err,{logType:'PM Success Error (from window)',bugType:'partner',extraData:{params:JSON.stringify(data)||"",callback:String(success)}});}}}});}});}});pm.bind('getPaidProductsCategories',function(data){return spApi.storageData("prodCats");});pm.bind('sQueryPM',function(data){var result=null;try{result=spApi.e('('+decodeURI(data.callback)+')('+data.data+')');}catch(err){spApi.errLog(err,{logType:'PM Error (from window)',bugType:'partner',extraData:{campId:data.campId,params:JSON.stringify(data.data)||"",callback:String(decodeURI(data.callback))}});}
return result;});pm.bind("getUserIdFromPartnerDomain",function(){var spUID=sQuery.cookie("spUID");return spUID;});pm.bind('spApiPM',function(data){var result=spApi.e(data.query);if(result)return result;});pm.bind('autoFit',function(data){var params={'height':data.height,'width':data.width};if(typeof data.onlyHeight!=="undefined"&&data.onlyHeight==true){var campIdPrefix='';var advancedCssClass=''
if(typeof data.campId!=='undefined'){campIdPrefix='-'+data.campId;advancedCssClass='.sp-advanced-css-'+data.campId+' ';}
params={'height':data.height};sQuery('#insdrInfoHeightStyle'+campIdPrefix).remove();sQuery('body').append('<style id="insdrInfoHeightStyle'+campIdPrefix+'">'+
advancedCssClass+'.sp-fancybox-inner, '+advancedCssClass+'.sp-inline-iframe { height: '+data.height+'px !important; }'+'</style>');}else{sQuery('.sp-fancybox-outer').css(params);sQuery('.sp-fancybox-wrap').css(params);sQuery('.sp-fancybox-skin').css(params);sQuery(".sp-fancybox-inner").css(params);sQuery(".sp-fancybox-iframe").css(params);sQuery('.sp-fancybox-wrap').css("visibility","visible");}});pm.bind('close-fancybox',function(data){var updateCookieType=typeof data.updateCookieType!=='undefined'?data.updateCookieType:'';var effectConfig;var positionType;var camp=spApi.getCamp(data.campId).camp;var notifySettings=spApi.notifies[camp.id];effectConfig=notifySettings.effectConfig;if(camp.productType==24){positionType=notifySettings.locationConfig.type;}
var closeCamp=function(){if(typeof notifySettings!="undefined"&&typeof notifySettings.locationConfig!="undefined"&&positionType=="2"){sQuery('.sp-inline-wrap-'+camp.id).remove();}else{sQuery.fancybox.close();}};var closeEffect=function(){if(typeof notifySettings!="undefined"&&typeof notifySettings.locationConfig!="undefined"&&positionType=="2"){sQuery('.sp-inline-wrap-'+camp.id).effective(effectConfig.close);}else{sQuery('.sp-fancybox-skin').effective(effectConfig.close);}}
if(effectConfig instanceof Object&&typeof effectConfig.close!=="undefined"){effectConfig.close.dialog.complete=function(){closeCamp();}
closeEffect();}else{closeCamp();}
if(data.cookieType=="liked"){data={key:'sp-camp-'+data.campId,obj:{'liked':data.cookieValue},campId:data.campId};spApi.updateCookie(data);}else if(data.cookieType=="closed"){data={key:'sp-camp-'+data.campId,obj:{'closed':true},campId:data.campId};spApi.updateCookie(data,updateCookieType);}
if(typeof spApi.mask.isLoaded()!=="undefined"){spApi.mask.closeSlient();}
sQuery('html').unbind('mousemove');});pm.bind('set-cookie',function(data){spApi.updateCookie(data);});pm.bind('execute',function(data){return spApi.e(data);});pm.bind('get-cookie',function(data){var c=sQuery.cookie(data.key)!=null?sQuery.cookie(data.key):spApi.storageData(data.key);if(c){c=JSON.parse(c);return{err:null,response:c};}else{return{err:true,response:false};}});pm.bind("getGlobalIdSettingStatus",function(data){return spApi.globalUserIdIsDisabled;});if(initCondition&&typeof spApi.worker=="undefined"&&(spApi.optOutRequestExists()||!spApi.isOptOut())){if(sQuery.cookie('spDebugMode')==1)
spApi.consoleLog.push("API is ready.");function insCreateUID(){var idStrLen=32;var spUID=(Math.floor((Math.random()*25))+10);spUID+=(new Date()).getTime();do{spUID+=(Math.floor((Math.random()*15))).toString(36);if(spUID.length==23)
spUID+=".";}while(spUID.length<idStrLen);return spUID;}
function gaLog(campId){_gaq.push(['_setCustomVar',5,'Insider',campId,2]);_gaq.push(['_trackEvent','SociaPlus','impression',campId]);}
var dimensionControl=false;WorkerFrame=function(){sQuery(document).on('userLocationSet',function(){spApi.worker.userIP('setUserIp',{userLocation:spApi.storageData('userLocation')});});var gaSegmentIsActive=false;sQuery.each(spApi.personalizationCamps,function(key,value){if(value.gaSegmentId!=''){gaSegmentIsActive=true;return false;}});var wf=this;sQuery('body').elementLoadComplete(function(){var workerFrame=document.createElement('iframe');workerFrame.style.display='none';workerFrame.id='spWorker';workerFrame.src='https://almosafernew.api.sociaplus.com/worker.html';workerFrame.onload=function(){wf._window=workerFrame.contentWindow;wf.ping();};document.body.appendChild(workerFrame);},{i:1,t:5000});};WorkerFrame.prototype.ping=function(callback){spApi.executedCallbacks=[];try{wf=this;var intervalId=setInterval(function(){if(sQuery('#spWorker').length>0){pm({target:wf._window,type:'are-you-ready',data:{no:"data",noLog:window.noLog},success:function(data){if(!dimensionControl){spApi.gaDimensionQ=data.dimensionResults;if(typeof spApi.setCustomSegments=='function'){spApi.setCustomSegments(spApi.customSegments);}
spApi.logger('info','Worker yüklendi...');dimensionControl=true;}
wf.ready=true;sQuery(document).trigger('workerFrameReady');spApi.salesSesId=spApi.Base64.encode(spApi.getGAStyleSesId());spApi.setCampSalesSesId();if(sQuery.cookie('spUID')==null){if(spApi.getBrowser()=='Safari'&&(data.spUID=='null'||data.spUID==null||data.spUID=='undefined')){data.spUID=insCreateUID();}
sQuery.cookie('spUID',data.spUID,{expires:spApi.getPrototype('uidExpireDate'),path:'/'});}else{sQuery.cookie('spUID',sQuery.cookie('spUID'),{expires:spApi.getPrototype('uidExpireDate'),path:'/'});pm({target:sQuery('#spWorker')[0].contentWindow,type:"set-spUID",data:{value:sQuery.cookie('spUID')}});}
clearInterval(intervalId);if(callback&&spApi.executedCallbacks.indexOf(callback.toString())===-1){spApi.executedCallbacks.push(callback.toString());callback();}}});}},10);}catch(err){}};WorkerFrame.prototype.send=function(type,data,callback){wf=this;if(this.ready){if(data.type=='joined'){spApi.gaSend(data);spApi.addDbLog(data);}
else{if(spApi.getBrowser()=='Safari'){data.userID=sQuery.cookie('spUID');}
var checkLogKey=true;if(typeof data.type==='undefined'||typeof data.campId==='undefined'||data.goalType==='productCategorySuccess'||data.goalType==='productSuccess'){checkLogKey=false;}
var timestamp=Math.floor(new Date().getTime()/1000);var logKey=data.type+'-'+timestamp+'-'+data.campId;if(typeof spApi.logsStack[logKey]==='undefined'||checkLogKey===false){spApi.logsStack[logKey]='1';pm({target:this._window,type:type,data:data,success:function(){spApi.logger('info','Worker ile '+data.type+' logu atıldı.',data.campId);if(data.type=='impression'||data.type=='join'||data.type=='camp-step1'||data.salesType=='sales'||data.salesType=='bounce-sales'||data.salesType=='variation-sales'||data.type=='closed'||data.type=='camp-step1-close'){spApi.gaSend(data);spApi.addDbLog(data);}else if(data.type=='sa-co'){spApi.addDbLog(data);}}});}}}else{setTimeout(function(){wf.send(type,data,callback);},1000)}};WorkerFrame.prototype.asyncPM=function(type,data,callback){wf=this;if(this.ready){pm({target:this._window,type:type,data:data,success:callback});}else{setTimeout(function(){wf.asyncPM(type,data,callback);},500);}};WorkerFrame.prototype.asyncFunc=function(func){wf=this;if(this.ready){func();}else{setTimeout(function(){func();},500);}};WorkerFrame.prototype.userIP=function(type,data,callback){wf=this;if(this.ready){pm({target:this._window,type:type,data:data,success:function(data){}});}else{setTimeout(function(){wf.userIP(type,data,callback);},1000)}}
WorkerFrame.prototype.sendCook=function(type,data,callback){wf=this;if(this.ready){pm({target:this._window,type:type,data:data,success:function(data){}});}else{setTimeout(function(){wf.send(type,data,callback);},1000)}};WorkerFrame.prototype.check=function(o,n,campId,callback){try{if(!campId)
return;else if(o==undefined&&n==undefined)
return;wf=this;var logType=[];sQuery.each(n,function(key,value){if(value==true){if(o==undefined||(o&&!o[key])){if(key=='step1-displayed'){logType.push('camp-step1');}else if(key=='step1-closed'){logType.push('camp-step1-close');}else if(key=='closedCouponTimer'){logType.push('closedCouponTimer');}else if(key=='couponAppliedTimer'){logType.push('couponAppliedTimer');}else if(key=='closed'){}else{logType.push(key);}}}});sQuery.each(logType,function(key,value){wf.send('do-logging',{type:value,campId:campId,paaRoiGroup:sQuery.parseJSON(spApi.storageData('sp-camp-'+campId)).paaRoiType,paaProductType:spApi.getCamp(campId).camp.productType},callback);});}catch(err){}};WorkerFrame.prototype.cookie=function(capsule,callback){wf=this;wf.sendCook(capsule.dataC.type,{data:capsule.dataC.cookie,key:capsule.dataC.key});};WorkerFrame.prototype.SetGlobalExperimentLog=function(logData){var logs=new Array('impression-A','impression-B','variation-sales-A','variation-sales-B');if(sQuery.inArray(logData.globalExperimentType,logs)>-1){spApi.worker.send('globalExperimentLogging',{type:logData.globalExperimentType,productType:'globalExperiment',ref:window.location.href});if(sQuery.inArray(logData.globalExperimentType,['impression-A','impression-B'])>-1){if(spApi.globalExperiment['gaPush']=="1"){var gaAction=(logData.globalExperimentType=='impression-A')?'Global-A':'Global-B';spApi.gaSend({type:'globalExperiment',action:gaAction,campId:0});}}}else{sQuery.post(spApi.apiUrl+'ajax.php?t=storeGlobalExperimentLog',logData);}}
WorkerFrame.prototype.SetGoalBuilderLog=function(logData){var key='sp-goal-'+logData.varId+'-'+logData.goalId;var subId=logData['subId']||'';if(logData.logType=='join'){var spGoal=spApi.storageData(key);logData.logType=(typeof spGoal=="undefined"||spGoal==null)?'join':'engage';}
var logKey=key+'-'+subId+'-'+logData.logType;if(sQuery.inArray(logKey,spApi.goalLogs)==-1){var other=(logData['other']!==undefined)?logData['other']:'';logData.builderId=logData.builderId.toString();logData.varId=logData.varId.toString();logData.goalId=logData.goalId.toString();var logs=new Array('engage','join','impression','sales');if(sQuery.inArray(logData.logType,logs)>-1){spApi.worker.send('goalBuilderLogging',{type:logData.logType,builderId:logData.builderId,varId:logData.varId,campId:logData.campId,goalId:logData.goalId,productType:logData.productType,goalType:logData.goalType,subId:subId,userId:logData.userId,ref:logData.ref,url:logData.url,other:other});if(logData.logType!='engage'){if(logData.logType=='join'){spApi.gaSend({builderId:logData.builderId,campId:logData.varId,type:'goal',goalId:logData.goalId});}
cData={key:key,obj:{'goalType':logData.logType},campId:logData["varId"]};spApi.updateCookie(cData,"nolog");}}else{var checkLogKey=true;if(typeof logData.logType==='undefined'||typeof logData.goalId==='undefined'){checkLogKey=false;}
var timestamp=Math.floor(new Date().getTime()/1000);var logKey=logData.logType+'-'+timestamp+'-'+logData.goalId;if(typeof spApi.logsStack[logKey]==='undefined'||checkLogKey===false){spApi.logsStack[logKey]='1';sQuery.post(spApi.apiUrl+'ajax.php?t=storeGoalBuilderLog',logData);}}
spApi.goalLogs.push(logKey);}}
WorkerFrame.prototype.SetCustomCampLog=function(logData){try{var other='';if(logData['other']!==undefined){other=logData['other'];}
var customSubId=logData['customSubId']||'';logData.campId=logData.campId.toString();if(logData.campId.indexOf('c')<0){logData.campId='c'+logData.campId;}
if(logData.logType=="joined"){if(!spApi.spCampCheckStatus(logData["campId"],'joined')&&logData.logType=="joined"){logData.logType="join";cData={key:'sp-camp-'+logData["campId"],obj:{'joined':true},campId:logData["campId"]};spApi.updateCookie(cData,"nolog");}
else{logData.logType="engage";}}
spApi.logger('info',logData.logType+' logu atılıyor.',logData.campId);var logs=['engage','join','impression'];if(sQuery.inArray(logData.logType,logs)>-1){var logParams={type:logData.logType,campId:logData.campId,productType:'custom',customSubId:customSubId,ref:window.location.href,orderId:spApi.isOnAfterPaymentPage()?spApi.getOrderId():'',paidProducts:(spApi.storageData('paid-products')!=null)?spApi.storageData('paid-products'):'',sessionId:spApi.salesSesId,salesSesId:spApi.getCampSalesSesInfo(logData.campId,'salesSesId'),salesSesTime:spApi.getCampSalesSesInfo(logData.campId,'salesSesTime')+'-'+spApi.getTime(),other:other};logParams=sQuery.extend(logParams,spApi.getStandardLogData());logParams.pixelTrack=true;spApi.worker.send('do-logging',logParams);}else{var checkLogKey=true;if(typeof logData.logType==='undefined'||typeof logData.campId==='undefined'){checkLogKey=false;}
var timestamp=Math.floor(new Date().getTime()/1000);var logKey=logData.logType+'-'+timestamp+'-'+logData.campId;if(typeof spApi.logsStack[logKey]==='undefined'||checkLogKey===false){spApi.logsStack[logKey]='1';sQuery.post(spApi.apiUrl+'ajax.php?t=storeCustomLog',logData);}}}catch(err){spApi.errLog(err);}}
spApi.worker=new WorkerFrame();spApi.loaded=true;}
if(spApi.isBrowserSupportEnabled()){if(initCondition){function parseLocationData(data){}
function parseWeatherData(data){}
function parsePredictiveData(data){}
function parseCustomDataSet(data){}
function parseGaSegmentData(data){}
var _flushPredictiveData=function(){var migrated='1';var optionalSegmentList=["5fd030adf0b27ae905e9b1256d58a8b9"];var predictiveData=JSON.parse(spApi.storageData('predictiveData'));var predictiveMigrateIsUndefined=typeof predictiveData.migrated==='undefined';var predictiveIsMigrated=predictiveData.migrated==='1';var newKeyExists=false;optionalSegmentList.forEach(function(segmentKey){if(typeof predictiveData[segmentKey]==='undefined'){newKeyExists=true;}});if(newKeyExists||(migrated==='1'&&predictiveMigrateIsUndefined)||(migrated==='0'&&!predictiveMigrateIsUndefined&&predictiveIsMigrated)){return true;}
return false;};function loadUserLocation(){try{sQuery.ajax({url:'//locationv2.api.sociaplus.com/?partnerName=almosafernew',type:"get",dataType:"jsonp",async:spApi.isAjaxAsync,jsonpCallback:"parseLocationData",success:function(data){var geoData={geoId:'',city:'',country:'',cName:'',request:'',latitude:'',longitude:''};if(spApi.objKeys(data)){geoData.geoId=data.cityNameId;geoData.city=data.cityName;geoData.country=data.countryCode;geoData.cName=data.countrName;geoData.request=data.ip;geoData.latitude=data.latitude;geoData.longitude=data.longitude;spApi.storageData('userLocation',geoData,{expires:1});}else{spApi.storageData('userLocation',geoData,{expires:1});}
sQuery(document).trigger('userLocationSet');}});}catch(err){spApi.errLog(err);}}
function loadWeatherInfo(weatherTypes){try{if(window.weatherSet==undefined){sQuery.ajax({url:'//weatherv2.api.sociaplus.com/?v=2',type:"get",dataType:"jsonp",async:spApi.isAjaxAsync,jsonpCallback:"parseWeatherData",success:function(data){if(spApi.objKeys(data)){var nextHour=new Date();nextHour.setHours(nextHour.getHours()+1);var currentData=data.current;var weeklyData=data.weekly;var dt={summary:currentData.summary,type:currentData.type,temperature:currentData.temperature,windspeed:currentData.windspeed,humidity:currentData.humidity,expireDate:nextHour.getTime()};spApi.sessionStorageSet("weatherInfo-current",JSON.stringify(dt));var dt={weekly:weeklyData,expireDate:nextHour.getTime()};spApi.sessionStorageSet("weatherInfo-weekly",JSON.stringify(dt));}}});}}catch(err){spApi.errLog(err);}}
function loadPredictiveData(callback){try{segmentApiLastRequestTime=spApi.storageData('segmentApiLastRequestTime');var threeMinutes=180000;var requestTimeLimit=parseInt(segmentApiLastRequestTime)===NaN||new Date().getTime()-segmentApiLastRequestTime>threeMinutes;if(requestTimeLimit&&((!spApi.storageData('predictiveData')&&window.predictiveSet==undefined)||spApi.unificationEventSucceed||_flushPredictiveData())){spApi.storageData('segmentApiLastRequestTime',new Date().getTime(),{expires:1});var getspUID=setInterval(function(data){if(sQuery('#spWorker')[0]){pm({target:sQuery('#spWorker')[0].contentWindow,type:'getSPUData',success:function(spUData){if(spUData.updateSpUIDPartnerDomain!==null){clearInterval(getspUID);if(window.predictiveSet==undefined){window.predictiveSet=true;sQuery.ajax({url:'//segments.api.sociaplus.com/v3/segments/'+spUData.spUID+'?partnerid=10002063&jsonp=true&fields=5fd030adf0b27ae905e9b1256d58a8b9',type:"get",dataType:"jsonp",async:spApi.isAjaxAsync,jsonpCallback:"parsePredictiveData",success:function(data){if(migrated==='1'){data.migrated='1';}
spApi.storageData('predictiveData',data,{expires:1});if(typeof callback!=='undefined'){callback();}}});}}}});}},"1000");}}catch(err){spApi.errLog(err);}}
function getDataset(segmentList){var loopCounter=Math.floor(segmentList.length/40);var segmentListForDataList=[];for(var i=0;i<=loopCounter;i++){segmentListForDataList[i]=segmentList.slice(i*40,(i+1)*40);var callbackName='insParseCustomDataSet'+i;window[callbackName]=function(data){};sQuery.ajax({url:spApi.apiUrl+'customDataSegmentation.php',type:'POST',data:{segmentList:JSON.stringify(segmentListForDataList[i]),callback:callbackName,counter:i},dataType:'jsonp',async:spApi.isAjaxAsync,jsonpCallback:callbackName,success:function(dataset){if(dataset.success){sQuery.each(dataset.success,function(segmentName,result){sQuery.each(segmentListForDataList[dataset.counter],function(index,segment){if(segmentName===segment.sn){var key='customDataSet-'+segmentName;var data={status:result,cookie:segment.cv};localStorage.setItem(key,JSON.stringify(data));}});});}}});}}
function loadCustomDataSet(customDataset){try{var segmentList=[];sQuery.each(customDataset,function(index,rule){if(typeof rule!=='undefined'){var regex=/checkCustomDataset\(([^)]+)\)/g
var matches=[];var match=regex.exec(rule.test.replace(/[^()-_,\w\s]/gi,''));while(match!=null){matches.push(match[1]);match=regex.exec(rule.test.replace(/[^()-_,\w\s]/gi,''));}
sQuery.each(matches,function(index,ruleTest){var ruleMatch=ruleTest.split(',');if(typeof ruleMatch['1']!=='undefined'){var cookieKey=ruleMatch['0'];var segmentName=ruleMatch['1'].trim();if(typeof rule.isProcessed!=='undefined'&&rule.isProcessed){var cookieValue=sQuery.cookie(cookieKey);var key='customDataSet-'+segmentName;var customSet=JSON.parse(localStorage.getItem(key));if(!customSet||typeof customSet=='number'||(typeof customSet=='object'&&customSet.cookie!=cookieValue)){if(cookieValue){var data={cv:cookieValue,sn:segmentName};segmentList.push(data);}else{var data={status:0,cookie:cookieValue};localStorage.setItem(key,JSON.stringify(data));}}else if(!cookieValue&&customSet.status){var data={status:0,cookie:cookieValue};localStorage.setItem(key,JSON.stringify(data));}}}});}});if(segmentList.length){getDataset(segmentList);}}catch(err){spApi.errLog(err,{logType:'loadCustomDataSet',bugType:'product',extraData:{customDataset:customDataset}});}}
function loadGaSegmentData(gaSegmentList){if(gaSegmentList.length>0){var checkSPUID=false;var getspUID=setInterval(function(data){if(sQuery('#spWorker')[0]){pm({target:sQuery('#spWorker')[0].contentWindow,type:'getSPUData',success:function(spUData){if(checkSPUID)return false;checkSPUID=true;clearInterval(getspUID);sQuery.ajax({url:spApi.apiUrl+'ajax.php?t=getGaSegment',type:"POST",data:{gaSegmentList:JSON.stringify(gaSegmentList),spUID:spUData.spUID},dataType:"jsonp",async:spApi.isAjaxAsync,jsonpCallback:"parseGaSegmentData",success:function(gaSegmentData){if(gaSegmentData){sQuery.each(gaSegmentData,function(index,gaSegment){var segmentKey='gaSegment-'+gaSegment.personalizationId;localStorage.setItem(segmentKey,gaSegment.status);});}}});}});}},"300");}}
try{var now=new Date();var customDataset=[];var getWeatherData=false;var migrated='1';if(!spApi.isSiteUrlCheckFailed()){sQuery.each(spApi.rules,function(i,val){rule=spApi.rules[i];if(rule.test.indexOf("Predictive")>-1||rule.test.indexOf("BehavioralSegments")>-1||rule.test.indexOf("checkAdAudience")>-1){var localStorageValue=JSON.parse(localStorage.getItem('predictiveData'));if(localStorageValue!==null&&typeof localStorageValue.expireDate!=='undefined'){if(localStorageValue.expireDate>(new Date()).getTime()){spApi.storageData('predictiveData',localStorageValue,{expires:(new Date(localStorageValue.expireDate))});}else{loadPredictiveData();}}else{if(!spApi.storageData('predictiveData')){loadPredictiveData();}else if(_flushPredictiveData()){loadPredictiveData();}}}
if(rule.test.indexOf("CustomDataset")>-1){customDataset[rule.id]=rule;}
if(rule.weatherActive=='1'){getWeatherData=true;}});}
if(customDataset.length){loadCustomDataSet(customDataset);}
if(true){var locationStorageValue=JSON.parse(localStorage.getItem('userLocation'));if(locationStorageValue!==null&&typeof locationStorageValue.expireDate!=='undefined'){if(locationStorageValue.expireDate>(new Date()).getTime()){spApi.storageData('userLocation',locationStorageValue,{expires:(new Date(locationStorageValue.expireDate))});}else{loadUserLocation();}}else if(spApi.storageData('userLocation')==null){loadUserLocation();}}
if(getWeatherData){if(!spApi.sessionStorageGet('weatherInfo-current')||!spApi.sessionStorageGet('weatherInfo-weekly')){loadWeatherInfo();window.weatherSet=true;}else{var currentWeatherInfoDate=JSON.parse(spApi.sessionStorageGet('weatherInfo-current'));if(currentWeatherInfoDate!=null&&typeof currentWeatherInfoDate.expireDate!='undefined'){if(now.getTime()>=currentWeatherInfoDate.expireDate){spApi.sessionStorageRemoveItem('weatherInfo-current');loadWeatherInfo();window.weatherSet=true;}}else{spApi.sessionStorageRemoveItem('weatherInfo-current');loadWeatherInfo();window.weatherSet=true;}}}
var gaSegmentList=[];sQuery.each(spApi.personalizationCamps,function(key,value){if(value.gaSegmentId!=''){var segment={gaSegmentId:value.gaSegmentId,persId:key}
gaSegmentList.push(segment);}});loadGaSegmentData(gaSegmentList);if(true&&spApi.localStorageGet('insdrSV')==sQuery.cookie('insdrSV')){spApi.init();}else{spApi.logger('info','Partner storage mismatch, waiting for worker...');var insStorageInterval=setInterval(function(){if(spApi.worker.ready){pm({target:sQuery('#spWorker')[0].contentWindow,type:'storageData',data:{action:'read'},success:function(storageData){try{spApi.logger('info','Waiting for worker to making partner data syncronized');sQuery.each(storageData,function(property,value){spApi.localStorageSet(property,value);});spApi.localStorageSet('insdrSV',sQuery.cookie('insdrSV'));spApi.init();spApi.logger('info','API initialized');}catch(error){spApi.errLog(error);}}});clearInterval(insStorageInterval);}},100);}}catch(err){spApi.errLog(err);}}else{spApi.consoleLog.push("API is steady...");}
function setLocalStorage(storageName,storeValue){localStorage.setItem(storageName,JSON.stringify(storeValue));}
function getLocalStorage(storageName){try{return JSON.parse(localStorage.getItem(storageName))}catch(err){setLocalStorage(storageName,'');return[];}}
var isLocalStorageExist=function(storageName){var val=getLocalStorage(storageName);if(val!==null&&val!='\"\"'&&val!='')
return true;else
return false;}
function spGetTime(){return Math.round(new Date()/1000+3600);}
try{var uVDate=[];if(isLocalStorageExist('userDateV'))
uVDate=getLocalStorage('userDateV');if(uVDate.length==0||spGetTime()-uVDate[uVDate.length-1]>1800){uVDate.push(spGetTime());setLocalStorage('userDateV',uVDate);}
if(spApi.isOnAfterPaymentPage()){var userpaids=[];var paid={};if(spApi.storageData("paid-products")!=null&&spApi.storageData("paid-products").length>0){if(isLocalStorageExist('userpaids')){userpaids=getLocalStorage('userpaids');paid=sQuery.merge(JSON.parse(spApi.storageData("paid-products")),userpaids);}else{paid=JSON.parse(spApi.storageData("paid-products"));}
setLocalStorage('userpaids',paid);}}
if(spApi.isUserLoggedIn()){if(!isLocalStorageExist('loggedinUser'))
setLocalStorage('loggedinUser',1);}}catch(err){spApi.errLog(err);}}
else{spApi.consoleLog.push("Not supporting Internet Explorer 10 or below.");}}
spApi.loadScript('//api.sociaplus.com/js/squery.min.js',insiderMain);}else{var errorTwice="Warning : API is integrated more than once";(spApi.consoleLog==undefined)?spApi.consoleLog=[errorTwice]:spApi.consoleLog.push(errorTwice);}(function(){window.API_VERSION_almosafernew='v2.7.2';})();